\hypertarget{md_ExtRoutines_contents}{}\doxysection{Contents}\label{md_ExtRoutines_contents}

\begin{DoxyEnumerate}
\item \mbox{\hyperlink{md_ExtRoutines_monte-carlo-realization-generation}{Monte Carlo realization generation}} ~\newline
 a. \mbox{\hyperlink{md_ExtRoutines_svd-of-covariance-matrix}{SVD of Covariance Matrix}}~\newline
 b. \mbox{\hyperlink{md_ExtRoutines_multiplication-of-truncated-left-singular-value-matrix-with-standard-deviation-matrix}{Multiplication of truncated left singular value matrix with standard deviation matrix}}
\item \mbox{\hyperlink{md_ExtRoutines_do-initialization}{DO Initialization}} ~\newline
 a. \mbox{\hyperlink{md_ExtRoutines_svd-of-perturbation-matrix}{SVD of perturbation matrix}} ~\newline
 b. \mbox{\hyperlink{md_ExtRoutines_calculation-of-projection-matrix}{Calculation of Projection Matrix}}
\item \mbox{\hyperlink{md_ExtRoutines_do-solver}{DO Solver}} ~\newline

\end{DoxyEnumerate}\hypertarget{md_ExtRoutines_monte-carlo-realization-generation}{}\doxysection{Monte Carlo Realization generation}\label{md_ExtRoutines_monte-carlo-realization-generation}
\mbox{\hyperlink{md_ExtRoutines_contents}{Back to Contents}}\hypertarget{md_ExtRoutines_svd-of-covariance-matrix}{}\doxysubsection{SVD of Covariance matrix}\label{md_ExtRoutines_svd-of-covariance-matrix}
\mbox{\hyperlink{md_ExtRoutines_contents}{Back to Contents}}\hypertarget{md_ExtRoutines_autotoc_md1}{}\doxysubsubsection{Code Snippet}\label{md_ExtRoutines_autotoc_md1}

\begin{DoxyCode}{0}
\DoxyCodeLine{MKL\_INT m1 = N\_U, n = N\_U, lda = N\_U, ldu = N\_U, ldvt = N\_U, info;}
\DoxyCodeLine{double superb[std::min(N\_U, N\_U) -\/ 1];}
\DoxyCodeLine{}
\DoxyCodeLine{double *S = new double[N\_U];}
\DoxyCodeLine{double *U = new double[N\_U * N\_U];}
\DoxyCodeLine{double *Vt = new double[N\_U * N\_U];}
\DoxyCodeLine{}
\DoxyCodeLine{info = LAPACKE\_dgesvd(LAPACK\_ROW\_MAJOR, 'A', 'A', m1, n, C, lda,S, U, ldu, Vt, ldvt, superb);}
\DoxyCodeLine{}
\DoxyCodeLine{cout << endl}
\DoxyCodeLine{        << endl;}
\DoxyCodeLine{}
\DoxyCodeLine{if (info > 0)}
\DoxyCodeLine{\{}
\DoxyCodeLine{    printf("{}The algorithm computing SVD failed to converge.\(\backslash\)n"{});}
\DoxyCodeLine{    exit(1);}
\DoxyCodeLine{\}}
\DoxyCodeLine{cout << "{} SVD COMPUTED"{} << endl;}

\end{DoxyCode}
\hypertarget{md_ExtRoutines_autotoc_md2}{}\doxysubsubsection{Purpose}\label{md_ExtRoutines_autotoc_md2}
DGESVD computes the singular value decomposition (SVD) of a real {\ttfamily N\+\_\+U x N\+\_\+U} matrix {\ttfamily C}, also computing the left and/or right singular vectors. The SVD is written \begin{DoxyVerb} C = U * S * Vt
\end{DoxyVerb}


{\bfseries{Note that the routine returns V$\ast$$\ast$T, not V.}}\hypertarget{md_ExtRoutines_autotoc_md3}{}\doxysubsubsection{Input}\label{md_ExtRoutines_autotoc_md3}
{\ttfamily MATRIX\+\_\+\+LAYOUT} indicates whether the input and output matrices are stored in row major order or column major order, where\+: ~\newline
 matrix\+\_\+layout = {\ttfamily LAPACK\+\_\+\+ROW\+\_\+\+MAJOR}, the matrices are stored in row major order.

{\ttfamily JOBU} is CHARACTER$\ast$1 ~\newline
 Specifies options for computing all or part of the matrix ~\newline
 U \+:= {\ttfamily \textquotesingle{}A\textquotesingle{}}\+: all M columns of U are returned in array

{\ttfamily JOBVT} is CHARACTER$\ast$1 ~\newline
 Specifies options for computing all or part of the matrix ~\newline
 VT \+:= {\ttfamily \textquotesingle{}A\textquotesingle{}}\+: all N rows of V$\ast$$\ast$T are returned in the array VT;

{\ttfamily M} is INTEGER ~\newline
 The number of rows of the input matrix {\ttfamily C} (Covariance Matrix). ~\newline
 {\ttfamily m1 = N\+\_\+U}.

{\ttfamily N} is INTEGER ~\newline
 The number of columns of the input matrix {\ttfamily C} (Covariance Matrix). ~\newline
 {\ttfamily n = N\+\_\+U}.

A is DOUBLE PRECISION array, dimension (LDA,N), in our case {\ttfamily C} (Covariance Matrix)~\newline
 On entry, the M-\/by-\/N matrix {\ttfamily C}. ~\newline
 On exit, if {\ttfamily JOBU != \textquotesingle{}O\textquotesingle{}} and {\ttfamily JOBVT != \textquotesingle{}O\textquotesingle{}}, the contents of {\ttfamily C} are destroyed.

{\ttfamily LDA} is INTEGER ~\newline
 The leading dimension of the array {\ttfamily C}. ~\newline
 LDA \texorpdfstring{$>$}{>}= max(1,\+M) ~\newline
 {\ttfamily lda = N\+\_\+U}

{\ttfamily S} is DOUBLE PRECISION array, dimension (min(\+M,\+N))= {\ttfamily N\+\_\+U}. ~\newline
 The singular values of A, sorted so that S(i) \texorpdfstring{$>$}{>}= S(i+1).

{\ttfamily U} is DOUBLE PRECISION array, dimension {\ttfamily LDU x N\+\_\+U} ~\newline
 If {\ttfamily JOBU = \textquotesingle{}A\textquotesingle{}}, U contains the M-\/by-\/M orthogonal matrix U;

{\ttfamily LDU} is INTEGER ~\newline
 The leading dimension of the array U.~\newline
 {\ttfamily ldu = N\+\_\+U}

{\ttfamily Vt} is DOUBLE PRECISION array, {\ttfamily LDVT x N\+\_\+U} If JOBVT = \textquotesingle{}A\textquotesingle{}, {\ttfamily Vt} contains the {\ttfamily N\+\_\+U x N\+\_\+U} orthogonal matrix V$\ast$$\ast$T

{\ttfamily LDVT} is INTEGER ~\newline
 The leading dimension of the array VT. ~\newline
 {\ttfamily ldvt = N\+\_\+U}\hypertarget{md_ExtRoutines_autotoc_md4}{}\doxysubsubsection{Output}\label{md_ExtRoutines_autotoc_md4}
{\ttfamily S\mbox{[}i\mbox{]}, 0\texorpdfstring{$<$}{<}=i\texorpdfstring{$<$}{<}N\+\_\+U} ~\newline
 {\ttfamily U, N\+\_\+U x N\+\_\+U} ~\newline
 {\ttfamily Vt, N\+\_\+U x N\+\_\+U}

\DoxyHorRuler{0}
 \hypertarget{md_ExtRoutines_multiplication-of-truncated-left-singular-value-matrix-with-standard-deviation-matrix}{}\doxysubsection{Multiplication of truncated left singular value matrix with standard deviation matrix}\label{md_ExtRoutines_multiplication-of-truncated-left-singular-value-matrix-with-standard-deviation-matrix}
\mbox{\hyperlink{md_ExtRoutines_contents}{Back to Contents}}\hypertarget{md_ExtRoutines_autotoc_md5}{}\doxysubsubsection{Purpose}\label{md_ExtRoutines_autotoc_md5}
The dgemm routine calculates the product of double precision matrices ~\newline
 {\ttfamily C = alpha$\ast$(A x B) + k$\ast$C}~\newline
 Here, we want ~\newline
 {\ttfamily Realization\+Vector = Ut x Z}\hypertarget{md_ExtRoutines_autotoc_md6}{}\doxysubsubsection{Code snippet}\label{md_ExtRoutines_autotoc_md6}
{\ttfamily cblas\+\_\+dgemm(\+Cblas\+Row\+Major, Cblas\+No\+Trans, Cblas\+No\+Trans,m, n, k, alpha, A, k, B, n, beta, C, n);}\hypertarget{md_ExtRoutines_autotoc_md7}{}\doxysubsubsection{Input}\label{md_ExtRoutines_autotoc_md7}
{\ttfamily Cblas\+Row\+Major} ~\newline
 Indicates that the matrices are stored in row major order, with the elements of each row of the matrix stored contiguously.

{\ttfamily Cblas\+No\+Trans} ~\newline
 Enumeration type indicating that the matrices A and B should not be transposed or conjugate transposed before multiplication.

m, n, k Integers indicating the size of the matrices\+:

A \+: m rows by k columns~\newline
 B \+: k rows by n columns~\newline
 C \+: m rows by n columns~\newline
 Here, {\ttfamily A = Ut}, {\ttfamily B=Z}, {\ttfamily C = Realization\+Vector}, hence ~\newline
 {\ttfamily m = N\+\_\+U} ~\newline
 {\ttfamily n = N\+\_\+\+Realisations} ~\newline
 {\ttfamily k = mod\+Dim}

alpha Real value used to scale the product of matrices A and B.~\newline
 {\ttfamily alpha = 1.\+0}

A ~\newline
 Array used to store matrix A ({\ttfamily Ut} in our case)

k ~\newline
 Leading dimension of array A ({\ttfamily Ut}) , or the number of elements between successive rows (for row major storage) in memory. ~\newline
 {\ttfamily k = mod\+Dim}

B ~\newline
 Array used to store matrix B ({\ttfamily Z} in our case)

n ~\newline
 Leading dimension of array B ({\ttfamily Z}) , or the number of elements between successive rows (for row major storage) in memory. ~\newline
 {\ttfamily n = N\+\_\+\+Realisations}

beta ~\newline
 Real value used to scale matrix C ({\ttfamily Realization\+Vector}) {\ttfamily beta = 0.\+0}

C ~\newline
 Array used to store matrix C ({\ttfamily Realization\+Vector} in our case)

n Leading dimension of array C , or the number of elements between successive rows (for row major storage) in memory. {\ttfamily n = N\+\_\+\+Realisations} \DoxyHorRuler{0}
\hypertarget{md_ExtRoutines_do-initialization}{}\doxysection{DO Initialization}\label{md_ExtRoutines_do-initialization}
\mbox{\hyperlink{md_ExtRoutines_contents}{Back to Contents}} \hypertarget{md_ExtRoutines_svd-of-perturbation-matrix}{}\doxysubsection{SVD of perturbation matrix}\label{md_ExtRoutines_svd-of-perturbation-matrix}
\mbox{\hyperlink{md_ExtRoutines_contents}{Back to Contents}}
\begin{DoxyEnumerate}
\item \mbox{\hyperlink{md_ExtRoutines_if-number-of-realisations-is-greater-than-number-of-degrees-of-freedom}{If N\+\_\+\+Realisations \texorpdfstring{$>$}{>} N\+\_\+U}}
\item \mbox{\hyperlink{md_ExtRoutines_if-number-of-degrees-of-freedom-is-greater-than-number-of-realisations}{If N\+\_\+U \texorpdfstring{$>$}{>} N\+\_\+\+Realisations}}
\end{DoxyEnumerate}\hypertarget{md_ExtRoutines_if-number-of-realisations-is-greater-than-number-of-degrees-of-freedom}{}\doxysubsubsection{If number of realisations is greater than number of degrees of freedom}\label{md_ExtRoutines_if-number-of-realisations-is-greater-than-number-of-degrees-of-freedom}
\mbox{\hyperlink{md_ExtRoutines_svd-of-perturbation-matrix}{Back to SVD of perturbation matrix}} ~\newline
 {\ttfamily min(\+N\+\_\+\+R,\+N\+\_\+\+U) = N\+\_\+U}


\begin{DoxyCode}{0}
\DoxyCodeLine{int minDim = std::min(N\_U,N\_Realisations);}
\DoxyCodeLine{//Here, minDim = N\_U}
\DoxyCodeLine{MKL\_INT mDO = N\_U, nDO = N\_Realisations, ldaDO = N\_Realisations, lduDO = minDim, ldvtDO = N\_Realisations, infoDO;}
\DoxyCodeLine{double superbDO[minDim-\/1];}
\DoxyCodeLine{}
\DoxyCodeLine{double* PerturbationVectorCopy = new double[N\_U * N\_Realisations]();}
\DoxyCodeLine{memcpy(PerturbationVectorCopy,PerturbationVector,N\_U*N\_Realisations*SizeOfDouble);}
\DoxyCodeLine{}
\DoxyCodeLine{double* Sg = new double[minDim];}
\DoxyCodeLine{double* L = new double[N\_U*minDim];}
\DoxyCodeLine{double* Rt = new double[minDim*N\_Realisations];}
\DoxyCodeLine{}
\DoxyCodeLine{infoDO = LAPACKE\_dgesvd( LAPACK\_ROW\_MAJOR, 'S', 'N', mDO, nDO, PerturbationVectorCopy, ldaDO,}
\DoxyCodeLine{                    Sg, L, lduDO, Rt, ldvtDO, superbDO );}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{if( infoDO > 0 ) \{}
\DoxyCodeLine{    printf( "{}The algorithm computing SVD for DO failed to converge.\(\backslash\)n"{} );}
\DoxyCodeLine{    exit( 1 );}
\DoxyCodeLine{\}}
\DoxyCodeLine{cout << "{} DO SVD COMPUTED "{} <<endl;}

\end{DoxyCode}
\hypertarget{md_ExtRoutines_autotoc_md8}{}\doxysubsubsection{Purpose}\label{md_ExtRoutines_autotoc_md8}
DGESVD computes the singular value decomposition (SVD) of a real {\ttfamily N\+\_\+U x N\+\_\+\+Realisations} matrix {\ttfamily Perturbation\+Vector}, also computing the left and/or right singular vectors. The SVD is written \begin{DoxyVerb} PerturbationVector = L * Sg * Rt
\end{DoxyVerb}


{\bfseries{Note that the routine returns R$\ast$$\ast$T, not R.}}\hypertarget{md_ExtRoutines_autotoc_md9}{}\doxysubsubsection{Input}\label{md_ExtRoutines_autotoc_md9}
{\ttfamily MATRIX\+\_\+\+LAYOUT} indicates whether the input and output matrices are stored in row major order or column major order, where\+:~\newline
 matrix\+\_\+layout = {\ttfamily LAPACK\+\_\+\+ROW\+\_\+\+MAJOR}, the matrices are stored in row major order.

{\ttfamily JOBU} is CHARACTER$\ast$1~\newline
 Specifies options for computing all or part of the matrix ~\newline
 L \+:= {\ttfamily \textquotesingle{}S\textquotesingle{}}\+: the first {\ttfamily min(\+N\+\_\+\+U,\+N\+\_\+\+Realisation)} columns of U (the left singular matrix)~\newline
 {\bfseries{Here we are assuming}} {\ttfamily N\+\_\+\+Realisations \texorpdfstring{$>$}{>} N\+\_\+U}, {\bfseries{hence U will have dimension}} {\ttfamily N\+\_\+U x N\+\_\+U}

{\ttfamily JOBVT} is CHARACTER$\ast$1 ~\newline
 Specifies options for computing all or part of the matrix~\newline
 VT \+:= {\ttfamily \textquotesingle{}N\textquotesingle{}}\+: no rows of V$\ast$$\ast$T (no right singular vectors) are computed.~\newline


\`{}{\ttfamily M} is INTEGER ~\newline
 The number of rows of the input matrix {\ttfamily Perturbation\+Vector\+Copy} (Copy of {\ttfamily Perturbation\+Vector}). ~\newline
 {\ttfamily m\+DO = N\+\_\+U}.

{\ttfamily N} is INTEGER ~\newline
 The number of columns of the input matrix {\ttfamily Perturbation\+Vector\+Copy}(Copy of {\ttfamily Perturbation\+Vector}). ~\newline
 {\ttfamily n\+DO = N\+\_\+\+Realisations}.

A is DOUBLE PRECISION array, dimension (LDA,N), in our case {\ttfamily Perturbation\+Vector\+Copy} (Copy of {\ttfamily Perturbation\+Vector})~\newline
 On entry, the M-\/by-\/N matrix {\ttfamily Perturbation\+Vector\+Copy}. ~\newline
 On exit, if {\ttfamily JOBU != \textquotesingle{}O\textquotesingle{}} and {\ttfamily JOBVT != \textquotesingle{}O\textquotesingle{}}, the contents of {\ttfamily Perturbation\+Vector\+Copy} are destroyed. (Hence we are using {\ttfamily Perturbation\+Vector\+Copy} and not {\ttfamily Perturbation\+Vector})

{\ttfamily LDA} is INTEGER ~\newline
 The leading dimension of the array {\ttfamily Perturbation\+Vector\+Copy}. ~\newline
 LDA \texorpdfstring{$>$}{>}= max(1,\+M)~\newline
 {\ttfamily lda = N\+\_\+\+Realisations} ~\newline
 {\bfseries{Assumption of {\ttfamily N\+\_\+\+Realisations \texorpdfstring{$>$}{>} N\+\_\+U} also applies here}}

{\ttfamily Sg} is DOUBLE PRECISION array, dimension (min(\+M,\+N))= {\ttfamily N\+\_\+U}. ~\newline
 The singular values of A, sorted so that S(i) \texorpdfstring{$>$}{>}= S(i+1).

{\ttfamily U} is DOUBLE PRECISION array, dimension {\ttfamily LDU x N\+\_\+U} ~\newline
 ~\newline
 If JOBU = \textquotesingle{}S\textquotesingle{}, U contains the first min(m,n) columns of U (the left singular vectors, stored columnwise)

{\ttfamily LDU} is INTEGER ~\newline
 The leading dimension of the array U.~\newline
 {\ttfamily ldu = N\+\_\+U}\hypertarget{md_ExtRoutines_autotoc_md10}{}\doxysubsubsection{Output}\label{md_ExtRoutines_autotoc_md10}
{\ttfamily Sg\mbox{[}i\mbox{]}, 0\texorpdfstring{$<$}{<}=i\texorpdfstring{$<$}{<}N\+\_\+U} ~\newline
 {\ttfamily L, N\+\_\+U x N\+\_\+U} ~\newline
 \DoxyHorRuler{0}
\hypertarget{md_ExtRoutines_if-number-of-degrees-of-freedom-is-greater-than-number-of-realisations}{}\doxysubsubsection{If number of degrees of freedom is greater than number of realisations}\label{md_ExtRoutines_if-number-of-degrees-of-freedom-is-greater-than-number-of-realisations}
\mbox{\hyperlink{md_ExtRoutines_svd-of-perturbation-matrix}{Back to SVD of perturbation matrix}} ~\newline
 {\ttfamily min(\+N\+\_\+\+R,\+N\+\_\+\+U) = N\+\_\+\+Realisations}


\begin{DoxyCode}{0}
\DoxyCodeLine{int minDim = std::min(N\_U,N\_Realisations);}
\DoxyCodeLine{//Here, minDim = N\_Realisations}
\DoxyCodeLine{MKL\_INT mDO = N\_U, nDO = N\_Realisations, ldaDO = N\_Realisations, lduDO = minDim, ldvtDO = N\_Realisations, infoDO;}
\DoxyCodeLine{double superbDO[minDim-\/1];}
\DoxyCodeLine{}
\DoxyCodeLine{double* PerturbationVectorCopy = new double[N\_U * N\_Realisations]();}
\DoxyCodeLine{memcpy(PerturbationVectorCopy,PerturbationVector,N\_U*N\_Realisations*SizeOfDouble);}
\DoxyCodeLine{}
\DoxyCodeLine{double* Sg = new double[minDim];}
\DoxyCodeLine{double* L = new double[N\_U*minDim];}
\DoxyCodeLine{double* Rt = new double[minDim*N\_Realisations];}
\DoxyCodeLine{}
\DoxyCodeLine{infoDO = LAPACKE\_dgesvd( LAPACK\_ROW\_MAJOR, 'S', 'N', mDO, nDO, PerturbationVectorCopy, ldaDO,}
\DoxyCodeLine{                    Sg, L, lduDO, Rt, ldvtDO, superbDO );}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{if( infoDO > 0 ) \{}
\DoxyCodeLine{    printf( "{}The algorithm computing SVD for DO failed to converge.\(\backslash\)n"{} );}
\DoxyCodeLine{    exit( 1 );}
\DoxyCodeLine{\}}
\DoxyCodeLine{cout << "{} DO SVD COMPUTED "{} <<endl;}

\end{DoxyCode}
\hypertarget{md_ExtRoutines_autotoc_md11}{}\doxysubsubsection{Purpose}\label{md_ExtRoutines_autotoc_md11}
DGESVD computes the singular value decomposition (SVD) of a real {\ttfamily N\+\_\+U x N\+\_\+\+Realisations} matrix {\ttfamily Perturbation\+Vector}, also computing the left and/or right singular vectors. The SVD is written \begin{DoxyVerb} PerturbationVector = L * Sg * Rt
\end{DoxyVerb}


{\bfseries{Note that the routine returns R$\ast$$\ast$T, not R.}}\hypertarget{md_ExtRoutines_autotoc_md12}{}\doxysubsubsection{Input}\label{md_ExtRoutines_autotoc_md12}
{\ttfamily MATRIX\+\_\+\+LAYOUT} indicates whether the input and output matrices are stored in row major order or column major order, where\+:~\newline
 matrix\+\_\+layout = {\ttfamily LAPACK\+\_\+\+ROW\+\_\+\+MAJOR}, the matrices are stored in row major order.

{\ttfamily JOBU} is CHARACTER$\ast$1~\newline
 Specifies options for computing all or part of the matrix ~\newline
 L \+:= {\ttfamily \textquotesingle{}S\textquotesingle{}} \+: the first {\ttfamily min(\+N\+\_\+\+U,\+N\+\_\+\+Realisation)} columns of U (the left singular matrix)~\newline
 {\bfseries{Here we are assuming}} {\ttfamily N\+\_\+U \texorpdfstring{$>$}{>} N\+\_\+\+Realisations}, {\bfseries{hence U will have dimension}} {\ttfamily N\+\_\+U x N\+\_\+\+Realisations}

{\ttfamily JOBVT} is CHARACTER$\ast$1 ~\newline
 Specifies options for computing all or part of the matrix~\newline
 VT \+:= {\ttfamily \textquotesingle{}N\textquotesingle{}}\+: no rows of V$\ast$$\ast$T (no right singular vectors) are computed.~\newline


{\ttfamily M} is INTEGER ~\newline
 The number of rows of the input matrix {\ttfamily Perturbation\+Vector\+Copy} (Copy of {\ttfamily Perturbation\+Vector}). ~\newline
 {\ttfamily m\+DO = N\+\_\+U}.

{\ttfamily N} is INTEGER ~\newline
 The number of columns of the input matrix {\ttfamily Perturbation\+Vector\+Copy} (Copy of {\ttfamily Perturbation\+Vector}). ~\newline
 {\ttfamily n\+DO = N\+\_\+\+Realisations}.

A is DOUBLE PRECISION array, dimension (LDA,N), in our case {\ttfamily Perturbation\+Vector\+Copy} (Copy of {\ttfamily Perturbation\+Vector})~\newline
 On entry, the M-\/by-\/N matrix {\ttfamily Perturbation\+Vector\+Copy}. ~\newline
 On exit, if {\ttfamily JOBU != \textquotesingle{}O\textquotesingle{}} and {\ttfamily JOBVT != \textquotesingle{}O\textquotesingle{}}, the contents of {\ttfamily Perturbation\+Vector\+Copy} are destroyed.(Hence we are using {\ttfamily Perturbation\+Vector\+Copy} and not {\ttfamily Perturbation\+Vector})

{\ttfamily LDA} is INTEGER ~\newline
 The leading dimension of the array {\ttfamily Perturbation\+Vector\+Copy}. ~\newline
 LDA \texorpdfstring{$>$}{>}= max(1,\+M)~\newline
 {\ttfamily lda = N\+\_\+\+Realisations} ~\newline


{\ttfamily Sg} is DOUBLE PRECISION array, dimension (min(\+M,\+N))= {\ttfamily N\+\_\+\+Realisations}. ~\newline
 The singular values of A, sorted so that S(i) \texorpdfstring{$>$}{>}= S(i+1).

{\ttfamily U} is DOUBLE PRECISION array, dimension {\ttfamily LDU x N\+\_\+U} ~\newline
 ~\newline
 If JOBU = \textquotesingle{}S\textquotesingle{}, U contains the first min(m,n) columns of U (the left singular vectors, stored columnwise)

{\ttfamily LDU} is INTEGER ~\newline
 The leading dimension of the array U.~\newline
 {\ttfamily ldu = N\+\_\+\+Realisations}\hypertarget{md_ExtRoutines_autotoc_md13}{}\doxysubsubsection{Output}\label{md_ExtRoutines_autotoc_md13}
{\ttfamily Sg\mbox{[}i\mbox{]}, 0\texorpdfstring{$<$}{<}=i\texorpdfstring{$<$}{<}N\+\_\+\+Realisations} ~\newline
 {\ttfamily L, N\+\_\+U x N\+\_\+\+Realisations}

\DoxyHorRuler{0}
\hypertarget{md_ExtRoutines_calculation-of-projection-matrix}{}\doxysubsection{Calculation of Projection Matrix}\label{md_ExtRoutines_calculation-of-projection-matrix}
\mbox{\hyperlink{md_ExtRoutines_contents}{Back to Contents}} \hypertarget{md_ExtRoutines_autotoc_md14}{}\doxysubsubsection{Purpose}\label{md_ExtRoutines_autotoc_md14}
The dgemm routine calculates the product of double precision matrices ~\newline
 {\ttfamily C = alpha$\ast$(A x B) + k$\ast$C}~\newline
 Here, we want ~\newline
 {\ttfamily Projection\+Vector = Perturbation\+Vector$^\wedge$T x L}\hypertarget{md_ExtRoutines_autotoc_md15}{}\doxysubsubsection{Code snippet}\label{md_ExtRoutines_autotoc_md15}

\begin{DoxyCode}{0}
\DoxyCodeLine{cblas\_dgemm(CblasRowMajor,CblasTrans,CblasNoTrans,N\_Realisations,minDim,N\_U,1.0,PerturbationVector,N\_Realisations,L,minDim,0.0,ProjectionVector,minDim);}

\end{DoxyCode}
\hypertarget{md_ExtRoutines_autotoc_md16}{}\doxysubsubsection{Input}\label{md_ExtRoutines_autotoc_md16}
{\ttfamily Cblas\+Row\+Major} ~\newline
 Indicates that the matrices are stored in row major order, with the elements of each row of the matrix stored contiguously.

{\ttfamily Cblas\+Trans} ~\newline
 Enumeration type indicating that the matrix {\ttfamily Perturbation Vector} should be transposed before multiplication.

{\ttfamily Cblas\+No\+Trans} ~\newline
 Enumeration type indicating that {\ttfamily L} should not be transposed or conjugate transposed before multiplication.

{\ttfamily m, n, k} Integers indicating the size of the matrices\+:

A \+: m rows by k columns~\newline
 B \+: k rows by n columns~\newline
 C \+: m rows by n columns~\newline
 Here, {\ttfamily A = Perturbation\+Vector$^\wedge$T}, {\ttfamily B=L}, {\ttfamily C = Projection\+Vector}, hence ~\newline
 {\ttfamily m = N\+\_\+\+Realisations} ~\newline
 {\ttfamily n = min\+Dim} ~\newline
 {\ttfamily k = N\+\_\+U}

alpha Real value used to scale the product of matrices A and B.~\newline
 {\ttfamily alpha = 1.\+0}

A ~\newline
 Array used to store matrix A ({\ttfamily Perturbation\+Vector} transposed using Cblas\+Trans in our case)

k ~\newline
 Leading dimension of array A ({\ttfamily Perturbation\+Vector}) , or the number of elements between successive rows (for row major storage) in memory. ~\newline
 {\ttfamily k = N\+\_\+\+Realisations}

B ~\newline
 Array used to store matrix B ({\ttfamily L} in our case)

n ~\newline
 Leading dimension of array B ({\ttfamily L}) , or the number of elements between successive rows (for row major storage) in memory. ~\newline
 {\ttfamily n = min\+Dim}

beta ~\newline
 Real value used to scale matrix C ({\ttfamily Projection\+Vector}) {\ttfamily beta = 0.\+0}

C ~\newline
 Array used to store matrix C ({\ttfamily Projection\+Vector} in our case)

n Leading dimension of array C , or the number of elements between successive rows (for row major storage) in memory. {\ttfamily n = min\+Dim}

\DoxyHorRuler{0}
\hypertarget{md_ExtRoutines_do-solver}{}\doxysection{DO Solver}\label{md_ExtRoutines_do-solver}
\mbox{\hyperlink{md_ExtRoutines_contents}{Back to Contents}}\hypertarget{md_ExtRoutines_autotoc_md17}{}\doxysubsection{Covariance Matrix}\label{md_ExtRoutines_autotoc_md17}
