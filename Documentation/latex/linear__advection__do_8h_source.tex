\hypertarget{linear__advection__do_8h_source}{}\doxysection{linear\+\_\+advection\+\_\+do.\+h}
\label{linear__advection__do_8h_source}\index{Examples/DO\_UQ/linear\_advection\_do.h@{Examples/DO\_UQ/linear\_advection\_do.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{2 \textcolor{comment}{// ===========================================================================//}}
\DoxyCodeLine{3 \textcolor{comment}{// Dynamically Orthogonal Field Equation Solution of Linear Advection Problem //}}
\DoxyCodeLine{4 \textcolor{comment}{// ===========================================================================//}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{comment}{// =======================================================================}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{// Purpose:     Example file for solving the set of dynamically orthogonal field}}
\DoxyCodeLine{9 \textcolor{comment}{//              equations for linear advection.  }}
\DoxyCodeLine{10 \textcolor{comment}{//              Features included in this example file -\/ }}
\DoxyCodeLine{11 \textcolor{comment}{//              1. Definition of boundary conditions, boundary values,}}
\DoxyCodeLine{12 \textcolor{comment}{//                 initial condition and bilinear coefficients}}
\DoxyCodeLine{13 \textcolor{comment}{//              2. Assembly functions for Mean Equation, Mode Equation}}
\DoxyCodeLine{14 \textcolor{comment}{//                 and Coefficient Equation}}
\DoxyCodeLine{15 \textcolor{comment}{//              3. Assembly function for RHS of Mode Equation}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 \textcolor{comment}{// Authors:      Sashikumaar Ganesan, Thivin Anandh, Divij Ghose}}
\DoxyCodeLine{18 \textcolor{comment}{//}}
\DoxyCodeLine{19 \textcolor{comment}{// History:     1> First iteration implemented on 18.03.2022}}
\DoxyCodeLine{20 \textcolor{comment}{//              2> Bug fixes on 24.03.2022}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{comment}{// =======================================================================}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 }
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <MacroCell.h>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <IsoBoundEdge.h>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <IsoInterfaceJoint.h>}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}}}
\DoxyCodeLine{31 \{}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <gridgen.h>}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \textcolor{keywordtype}{void} triangulate(\textcolor{keywordtype}{char} *, \textcolor{keyword}{struct} triangulateio *,}
\DoxyCodeLine{35                      \textcolor{keyword}{struct} triangulateio *, \textcolor{keyword}{struct} triangulateio *);}
\DoxyCodeLine{36 \}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{comment}{// Include files related to the cell looping for the RHS filling part.}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{preprocessor}{\#include <Domain.h>}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#include <Database.h>}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#include <FEDatabase2D.h>}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#include <LinAlg.h>}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#include <FESpace2D.h>}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#include <SystemTNSE2D.h>}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#include <SquareStructure2D.h>}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#include <Structure2D.h>}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#include <Output2D.h>}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#include <CD2DErrorEstimator.h>}}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#include <MainUtilities.h>}}
\DoxyCodeLine{51 \textcolor{comment}{// \#include <TimeUtilities.h>}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#include <TNSE2D\_ParamRout.h>}}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#include <TimeDiscRout.h>}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{57 \textcolor{preprocessor}{\#include <MooNMD\_Io.h>}}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#include <sys/stat.h>}}
\DoxyCodeLine{61 \textcolor{preprocessor}{\#include <sys/types.h>}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{preprocessor}{\#include <QuadAffin.h>}}
\DoxyCodeLine{64 \textcolor{preprocessor}{\#include <QuadBilinear.h>}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{comment}{//========================================================================//}}
\DoxyCodeLine{67 \textcolor{comment}{//                              Example File                              //}}
\DoxyCodeLine{68 \textcolor{comment}{// =======================================================================//}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{preprocessor}{\#define \_\_SIN3\_\_}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{keywordtype}{void} ExampleFile()}
\DoxyCodeLine{73 \{}
\DoxyCodeLine{74     OutPut(\textcolor{stringliteral}{"{}Example: Linear Advection -\/ Dynamically Orthogonal Field Equation Solution"{}} << endl);}
\DoxyCodeLine{75 \}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \textcolor{comment}{// exact solution}}
\DoxyCodeLine{78 \textcolor{keywordtype}{void} Exact(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} y, \textcolor{keywordtype}{double} *values)}
\DoxyCodeLine{79 \{}
\DoxyCodeLine{80     \textcolor{keywordtype}{double} t;}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     values[0] = exp(t) * (sin(2 * Pi * x) * sin(2 * Pi * y));}
\DoxyCodeLine{85     values[1] = exp(t) * 2 * Pi * cos(2 * Pi * x) * sin(2 * Pi * y);}
\DoxyCodeLine{86     values[2] = exp(t) * 2 * Pi * sin(2 * Pi * x) * cos(2 * Pi * y);}
\DoxyCodeLine{87     values[3] = 0;}
\DoxyCodeLine{88 \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \textcolor{comment}{// kind of boundary condition (for FE space needed)}}
\DoxyCodeLine{91 \textcolor{keywordtype}{void} BoundCondition(\textcolor{keywordtype}{int} BdComp, \textcolor{keywordtype}{double} t, BoundCond \&cond)}
\DoxyCodeLine{92 \{}
\DoxyCodeLine{93     \textcolor{comment}{//  cond = NEUMANN;}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95     \textcolor{comment}{//  if(BdComp == 1 || BdComp == 3 || BdComp == 2 )}}
\DoxyCodeLine{96     \textcolor{comment}{//  \{}}
\DoxyCodeLine{97     cond = DIRICHLET;}
\DoxyCodeLine{98     \textcolor{comment}{//  \}}}
\DoxyCodeLine{99 \}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{comment}{// value of boundary condition}}
\DoxyCodeLine{102 \textcolor{keywordtype}{void} BoundValue(\textcolor{keywordtype}{int} BdComp, \textcolor{keywordtype}{double} Param, \textcolor{keywordtype}{double} \&value)}
\DoxyCodeLine{103 \{}
\DoxyCodeLine{104     value = 0;}
\DoxyCodeLine{105 \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{comment}{// initial conditon}}
\DoxyCodeLine{108 \textcolor{keywordtype}{void} InitialCondition(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} y, \textcolor{keywordtype}{double} *values)}
\DoxyCodeLine{109 \{}
\DoxyCodeLine{110     \textcolor{keywordtype}{double} t,val;}
\DoxyCodeLine{111 }
\DoxyCodeLine{112     t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{113     \textcolor{comment}{// values[0] = exp(t)*(sin(2*Pi*x)*sin(2*Pi*y));}}
\DoxyCodeLine{114     \textcolor{comment}{// double val\_x = exp(-\/1.0* ( 1.0 / ( 1 -\/ pow((2*x-\/1),4) ) ));}}
\DoxyCodeLine{115     \textcolor{comment}{// double val\_y = exp(-\/1.0* ( 1.0 / ( 1 -\/ pow((2*y-\/1),4) ) ));}}
\DoxyCodeLine{116     \textcolor{comment}{// values[0] = val\_x*val\_y;}}
\DoxyCodeLine{117     }
\DoxyCodeLine{118     \textcolor{comment}{// double r = 0.1;}}
\DoxyCodeLine{119     \textcolor{comment}{// double centerx = 0.5;    }}
\DoxyCodeLine{120     \textcolor{comment}{// double centery = 0.5;}}
\DoxyCodeLine{121     \textcolor{comment}{// x = x -\/ centerx;}}
\DoxyCodeLine{122     \textcolor{comment}{// y = y -\/ centery; }}
\DoxyCodeLine{123     \textcolor{comment}{// double len = pow((x*x + y*y),0.5);}}
\DoxyCodeLine{124     \textcolor{comment}{// if( abs(x) < r \&\& abs(y) < r)}}
\DoxyCodeLine{125     \textcolor{comment}{// \{}}
\DoxyCodeLine{126     \textcolor{comment}{//  val = 1;}}
\DoxyCodeLine{127     \textcolor{comment}{// \}}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{comment}{// else}}
\DoxyCodeLine{130     \textcolor{comment}{//  val = 0;}}
\DoxyCodeLine{131 }
\DoxyCodeLine{132     \textcolor{comment}{// values[0] = val;}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134 \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{keywordtype}{void} BilinearCoeffs(\textcolor{keywordtype}{int} n\_points, \textcolor{keywordtype}{double} *X, \textcolor{keywordtype}{double} *Y,}
\DoxyCodeLine{137         \textcolor{keywordtype}{double} **parameters, \textcolor{keywordtype}{double} **coeffs)}
\DoxyCodeLine{138 \{}
\DoxyCodeLine{139   \textcolor{keywordtype}{double} eps=1/TDatabase::ParamDB-\/>PE\_NR;}
\DoxyCodeLine{140   \textcolor{keywordtype}{double} b1=1, b2=-\/1, c=1;}
\DoxyCodeLine{141   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{142   \textcolor{keywordtype}{double} *coeff;}
\DoxyCodeLine{143   \textcolor{keywordtype}{double} x, y;}
\DoxyCodeLine{144   \textcolor{keywordtype}{double} t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{145 }
\DoxyCodeLine{146   \textcolor{keywordflow}{for}(i=0;i<n\_points;i++)}
\DoxyCodeLine{147   \{}
\DoxyCodeLine{148     coeff = coeffs[i];}
\DoxyCodeLine{149     }
\DoxyCodeLine{150     x = X[i];}
\DoxyCodeLine{151     y = Y[i];}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     coeff[0] = 0;}
\DoxyCodeLine{154     coeff[1] = -\/sin(t)*0.2;}
\DoxyCodeLine{155     coeff[2] = cos(t)*0.2;}
\DoxyCodeLine{156     coeff[3] = 0;}
\DoxyCodeLine{157 }
\DoxyCodeLine{158     coeff[4] = 0.0;}
\DoxyCodeLine{159   \}}
\DoxyCodeLine{160 \}}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 }
\DoxyCodeLine{163 \textcolor{keywordtype}{void} DO\_Mean\_Equation\_Coefficients(\textcolor{keywordtype}{int} n\_points, \textcolor{keywordtype}{double} *X, \textcolor{keywordtype}{double} *Y,}
\DoxyCodeLine{164                                    \textcolor{keywordtype}{double} **parameters, \textcolor{keywordtype}{double} **coeffs)}
\DoxyCodeLine{165 \{}
\DoxyCodeLine{166     \textcolor{keywordtype}{double} eps = 1 / TDatabase::ParamDB-\/>PE\_NR;}
\DoxyCodeLine{167     \textcolor{keywordtype}{double} b1 = 1, b2 = -\/1, c = 1;}
\DoxyCodeLine{168     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{169     \textcolor{keywordtype}{double} *coeff;}
\DoxyCodeLine{170     \textcolor{keywordtype}{double} x, y;}
\DoxyCodeLine{171     \textcolor{keywordtype}{double} t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{172 }
\DoxyCodeLine{173     \textcolor{keywordflow}{for} (i = 0; i < n\_points; i++)}
\DoxyCodeLine{174     \{}
\DoxyCodeLine{175         coeff = coeffs[i];}
\DoxyCodeLine{176 }
\DoxyCodeLine{177         x = X[i];}
\DoxyCodeLine{178         y = Y[i];}
\DoxyCodeLine{179 }
\DoxyCodeLine{180         coeff[0] = 0;}
\DoxyCodeLine{181         coeff[1] = -\/sin(t)*0.2;}
\DoxyCodeLine{182         coeff[2] = cos(t)*0.2;}
\DoxyCodeLine{183         coeff[3] = 0;}
\DoxyCodeLine{184 }
\DoxyCodeLine{185         coeff[4] = 0.0;}
\DoxyCodeLine{186     \}}
\DoxyCodeLine{187 \}}
\DoxyCodeLine{188 }
\DoxyCodeLine{189 \textcolor{keywordtype}{void} DO\_Mode\_Equation\_Coefficients(\textcolor{keywordtype}{int} n\_points, \textcolor{keywordtype}{double} *X, \textcolor{keywordtype}{double} *Y,}
\DoxyCodeLine{190                                    \textcolor{keywordtype}{double} **parameters, \textcolor{keywordtype}{double} **coeffs)}
\DoxyCodeLine{191 \{}
\DoxyCodeLine{192     \textcolor{keywordtype}{double} eps = 1 / TDatabase::ParamDB-\/>PE\_NR;}
\DoxyCodeLine{193     \textcolor{keywordtype}{double} b1 = 1, b2 = -\/1, c = 1;}
\DoxyCodeLine{194     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{195     \textcolor{keywordtype}{double} *coeff;}
\DoxyCodeLine{196     \textcolor{keywordtype}{double} x, y;}
\DoxyCodeLine{197     \textcolor{keywordtype}{double} t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{198 }
\DoxyCodeLine{199     \textcolor{keywordflow}{for} (i = 0; i < n\_points; i++)}
\DoxyCodeLine{200     \{}
\DoxyCodeLine{201         coeff = coeffs[i];}
\DoxyCodeLine{202 }
\DoxyCodeLine{203         x = X[i];}
\DoxyCodeLine{204         y = Y[i];}
\DoxyCodeLine{205 }
\DoxyCodeLine{206         coeff[0] = 0;}
\DoxyCodeLine{207         coeff[1] = -\/sin(t)*0.2;}
\DoxyCodeLine{208     coeff[2] = cos(t)*0.2;}
\DoxyCodeLine{209         coeff[3] = 0;}
\DoxyCodeLine{210 }
\DoxyCodeLine{211         coeff[4] = 0.0;}
\DoxyCodeLine{212     \}}
\DoxyCodeLine{213 \}}
\DoxyCodeLine{214 }
\DoxyCodeLine{215 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{216 \textcolor{comment}{// ASSEMBLY FUNCTION}}
\DoxyCodeLine{217 \textcolor{comment}{// This fucntion will be called for Every Quadrature Point inside a Cell for Local Assembly}}
\DoxyCodeLine{218 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{219 \textcolor{keywordtype}{void} \mbox{\hyperlink{linear__advection__do__test_8h_aeeed0090e62327af95811c480240e08a}{DO\_Mean\_Equation\_Assembly}}(\textcolor{keywordtype}{double} quad\_wt, \textcolor{keywordtype}{double} *coeff, \textcolor{keywordtype}{double} *param,}
\DoxyCodeLine{220                                \textcolor{keywordtype}{double} hK, \textcolor{keywordtype}{double} **derivatives, \textcolor{keywordtype}{int} *N\_BaseFuncts, \textcolor{keywordtype}{double} ***LocMatrices, \textcolor{keywordtype}{double} **LocRhs)}
\DoxyCodeLine{221 \{}
\DoxyCodeLine{222 }
\DoxyCodeLine{223     \textcolor{comment}{// The below values N\_x, N\_y , etc are ARRAY of Values}}
\DoxyCodeLine{224     \textcolor{comment}{// Which provides Value of a Particular Shape function or its derivative ( Based on a DOF )}}
\DoxyCodeLine{225     \textcolor{comment}{// at the given Quadrature POint.}}
\DoxyCodeLine{226     \textcolor{comment}{// Here the Size of the Array is equal to the NUmber of DOF in the cell}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228     \textcolor{comment}{// For Eg : Orig0[1]  gives the derivative of Shape Function number 1 ( Shape function of DOF 1 ) w.r.t x}}
\DoxyCodeLine{229     \textcolor{comment}{// at the given Quadrature Point.}}
\DoxyCodeLine{230     \textcolor{comment}{// Take these values based on the MULTIINDEX DERIVATIVE}}
\DoxyCodeLine{231     \textcolor{keywordtype}{double} *N = derivatives[0];}
\DoxyCodeLine{232     \textcolor{keywordtype}{double} *Nx = derivatives[1];}
\DoxyCodeLine{233     \textcolor{keywordtype}{double} *Ny = derivatives[2];}
\DoxyCodeLine{234 }
\DoxyCodeLine{235 }
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{keywordtype}{double} **A11, *F1;}
\DoxyCodeLine{238     \textcolor{comment}{// double val = 0.0;}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     A11 = LocMatrices[0]; \textcolor{comment}{// Local Stiffenss matrix}}
\DoxyCodeLine{241 }
\DoxyCodeLine{242     F1 = LocRhs[0];}
\DoxyCodeLine{243 }
\DoxyCodeLine{244     \textcolor{keywordtype}{double} c0 = coeff[0]; \textcolor{comment}{// nu}}
\DoxyCodeLine{245     \textcolor{keywordtype}{double} b1 = coeff[1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{246     \textcolor{keywordtype}{double} b2 = coeff[2]; \textcolor{comment}{// b2}}
\DoxyCodeLine{247     \textcolor{keywordtype}{double} c = coeff[3];  \textcolor{comment}{// c}}
\DoxyCodeLine{248     \textcolor{keywordtype}{double} f = coeff[4];  \textcolor{comment}{// f}}
\DoxyCodeLine{249 }
\DoxyCodeLine{250     \textcolor{keywordtype}{int} N\_DOF\_perCell = N\_BaseFuncts[0];}
\DoxyCodeLine{251 }
\DoxyCodeLine{252     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < N\_DOF\_perCell; i++) \textcolor{comment}{// Test}}
\DoxyCodeLine{253     \{}
\DoxyCodeLine{254         \textcolor{comment}{// Assemble RHS}}
\DoxyCodeLine{255         F1[i] = 0.0; \textcolor{comment}{// TO DO}}
\DoxyCodeLine{256         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{257         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < N\_DOF\_perCell; j++) \textcolor{comment}{// Ansatz}}
\DoxyCodeLine{258         \{}
\DoxyCodeLine{259 }
\DoxyCodeLine{260             val += -\/1.0*(b1 * Nx[j] + b2 * Ny[j]) * N[i]; \textcolor{comment}{//   TO DO}}
\DoxyCodeLine{261             \textcolor{comment}{// val  +=  c0*((Nx[j] * Nx[i])   + (Ny[j] * Ny[i]) );//???}}
\DoxyCodeLine{262             \textcolor{comment}{// val  +=  c*N[i]*N[j];}}
\DoxyCodeLine{263 }
\DoxyCodeLine{264             A11[i][j] += val * quad\_wt;}
\DoxyCodeLine{265         \} \textcolor{comment}{// endfor j}}
\DoxyCodeLine{266     \}     \textcolor{comment}{// endfor i}}
\DoxyCodeLine{267 \}}
\DoxyCodeLine{268 }
\DoxyCodeLine{269 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{270 \textcolor{comment}{// ASSEMBLY FUNCTION}}
\DoxyCodeLine{271 \textcolor{comment}{// This fucntion will be called for Every Quadrature Point inside a Cell for Local Assembly}}
\DoxyCodeLine{272 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{273 \textcolor{keywordtype}{void} DO\_Mode\_Equation\_Assembly(\textcolor{keywordtype}{double} quad\_wt, \textcolor{keywordtype}{double} *coeff, \textcolor{keywordtype}{double} *param,}
\DoxyCodeLine{274                                \textcolor{keywordtype}{double} hK, \textcolor{keywordtype}{double} **derivatives, \textcolor{keywordtype}{int} *N\_BaseFuncts, \textcolor{keywordtype}{double} ***LocMatrices, \textcolor{keywordtype}{double} **LocRhs)}
\DoxyCodeLine{275 \{}
\DoxyCodeLine{276 }
\DoxyCodeLine{277     \textcolor{comment}{// The below values N\_x, N\_y , etc are ARRAY of Values}}
\DoxyCodeLine{278     \textcolor{comment}{// Which provides Value of a Particular Shape function or its derivative ( Based on a DOF )}}
\DoxyCodeLine{279     \textcolor{comment}{// at the given Quadrature POint.}}
\DoxyCodeLine{280     \textcolor{comment}{// Here the Size of the Array is equal to the NUmber of DOF in the cell}}
\DoxyCodeLine{281 }
\DoxyCodeLine{282     \textcolor{comment}{// For Eg : Orig0[1]  gives the derivative of Shape Function number 1 ( Shape function of DOF 1 ) w.r.t x}}
\DoxyCodeLine{283     \textcolor{comment}{// at the given Quadrature Point.}}
\DoxyCodeLine{284     \textcolor{comment}{// Take these values based on the MULTIINDEX DERIVATIVE}}
\DoxyCodeLine{285     \textcolor{keywordtype}{double} *N = derivatives[0];}
\DoxyCodeLine{286     \textcolor{keywordtype}{double} *Nx = derivatives[1];}
\DoxyCodeLine{287     \textcolor{keywordtype}{double} *Ny = derivatives[2];}
\DoxyCodeLine{288 }
\DoxyCodeLine{289     \textcolor{keywordtype}{double} **A11, *F1;}
\DoxyCodeLine{290     \textcolor{keywordtype}{double} val = 0.;}
\DoxyCodeLine{291 }
\DoxyCodeLine{292     A11 = LocMatrices[0]; \textcolor{comment}{// Local Stiffenss matrix}}
\DoxyCodeLine{293 }
\DoxyCodeLine{294     F1 = LocRhs[0];}
\DoxyCodeLine{295 }
\DoxyCodeLine{296     \textcolor{keywordtype}{double} c0 = coeff[0]; \textcolor{comment}{// nu}}
\DoxyCodeLine{297     \textcolor{keywordtype}{double} b1 = coeff[1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{298     \textcolor{keywordtype}{double} b2 = coeff[2]; \textcolor{comment}{// b2}}
\DoxyCodeLine{299     \textcolor{keywordtype}{double} c = coeff[3];  \textcolor{comment}{// c}}
\DoxyCodeLine{300     \textcolor{keywordtype}{double} f = coeff[4];  \textcolor{comment}{// f}}
\DoxyCodeLine{301 }
\DoxyCodeLine{302     \textcolor{keywordtype}{int} N\_DOF\_perCell = N\_BaseFuncts[0];}
\DoxyCodeLine{303 }
\DoxyCodeLine{304     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < N\_DOF\_perCell; i++) \textcolor{comment}{// Test}}
\DoxyCodeLine{305     \{}
\DoxyCodeLine{306         \textcolor{comment}{// Assemble RHS}}
\DoxyCodeLine{307         F1[i] = 0.0; \textcolor{comment}{// TO DO}}
\DoxyCodeLine{308         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{309         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < N\_DOF\_perCell; j++) \textcolor{comment}{// Ansatz}}
\DoxyCodeLine{310         \{}
\DoxyCodeLine{311 \textcolor{comment}{// double val = 0;}}
\DoxyCodeLine{312             val += -\/1.0*(b1 * Nx[j] + b2 * Ny[j]) * N[i]; \textcolor{comment}{//   TO DO}}
\DoxyCodeLine{313             \textcolor{comment}{// val += c0 * ((Nx[j] * Nx[i]) + (Ny[j] * Ny[i]));}}
\DoxyCodeLine{314             \textcolor{comment}{// val += c * N[i] * N[j];}}
\DoxyCodeLine{315 }
\DoxyCodeLine{316             A11[i][j] += val * quad\_wt;}
\DoxyCodeLine{317         \} \textcolor{comment}{// endfor j}}
\DoxyCodeLine{318     \}     \textcolor{comment}{// endfor i}}
\DoxyCodeLine{319 \}}
\DoxyCodeLine{320 }
\DoxyCodeLine{321 \textcolor{keywordtype}{void} DO\_Mode\_RHS\_Aux\_Param(\textcolor{keywordtype}{double} *in, \textcolor{keywordtype}{double} *out)}
\DoxyCodeLine{322 \{}
\DoxyCodeLine{323     out = in;}
\DoxyCodeLine{324 \}}
\DoxyCodeLine{325 }
\DoxyCodeLine{327 }
\DoxyCodeLine{328 \textcolor{comment}{// This function will take care of the Additional terms that go into both the co-\/efficient equation and the mode equation}}
\DoxyCodeLine{329 \textcolor{comment}{// The terms in the Coefficient equation and the Mode equation are repeating , So the local RHS matrix will be reused in both the}}
\DoxyCodeLine{330 \textcolor{comment}{//}}
\DoxyCodeLine{331 }
\DoxyCodeLine{332 \textcolor{keywordtype}{void} \mbox{\hyperlink{linear__advection__do__test_8h_a95b3fb737c94e5ffcb06c258523d2b94}{DO\_Mode\_RHS}}(TFESpace2D *Fespace, TFEVectFunct2D *FeVector\_C, \textcolor{keywordtype}{int} N\_S,\textcolor{keywordtype}{double}* GlobalRhs\_mode , \textcolor{keywordtype}{int} i\_index)}
\DoxyCodeLine{333 \{}
\DoxyCodeLine{334 }
\DoxyCodeLine{335     \textcolor{keywordtype}{int} N\_Cells = Fespace-\/>GetN\_Cells();}
\DoxyCodeLine{336     TCollection* coll = Fespace-\/>GetCollection();}
\DoxyCodeLine{337 }
\DoxyCodeLine{338     \textcolor{comment}{// Get the Global DOF arrays INdex from the FE Space. }}
\DoxyCodeLine{339     \textcolor{keywordtype}{int}* GlobalNumbers = Fespace-\/>GetGlobalNumbers();}
\DoxyCodeLine{340     \textcolor{keywordtype}{int}* BeginIndex = Fespace-\/>GetBeginIndex();}
\DoxyCodeLine{341 }
\DoxyCodeLine{342     \textcolor{comment}{// -\/-\/-\/ Quadrature Formula Arrays  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{343     \textcolor{keywordtype}{int} N\_Points2;}
\DoxyCodeLine{344     \textcolor{keywordtype}{double} *Weights2, *t1, *t2;      \textcolor{comment}{// Weights -\/ Quadrature Weights array ; t1  -\/-\/ Quadrature point ( xi ) in ref coordinate ; t2 -\/  Quadrature Point ( eta ) in Ref Coordinate }}
\DoxyCodeLine{345     \textcolor{keywordtype}{bool} Needs2ndDer[1]; }
\DoxyCodeLine{346     Needs2ndDer[0] = TRUE;}
\DoxyCodeLine{347     \textcolor{keywordtype}{double} AbsDetjk[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{348     \textcolor{keywordtype}{double} X[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{349     \textcolor{keywordtype}{double} Y[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{350 }
\DoxyCodeLine{351 }
\DoxyCodeLine{352     \textcolor{comment}{// FE Values Arrays }}
\DoxyCodeLine{353     \textcolor{keywordtype}{double}** origvaluesD00;           \textcolor{comment}{// Shape function values at quadrature Points}}
\DoxyCodeLine{354     \textcolor{keywordtype}{double}** origvaluesD10;           \textcolor{comment}{// Shape Function Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{355     \textcolor{keywordtype}{double}** origvaluesD01;           \textcolor{comment}{// Shape Function Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{356     \textcolor{keywordtype}{double}** origvaluesD20;           \textcolor{comment}{// Shape Function 2nd Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{357     \textcolor{keywordtype}{double}** origvaluesD02;           \textcolor{comment}{// Shape Function 2nd Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{358 }
\DoxyCodeLine{359 }
\DoxyCodeLine{360     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} cellId = 0; cellId < 1; cellId++)}
\DoxyCodeLine{361     \{}
\DoxyCodeLine{362         TBaseCell* currentCell = coll-\/>GetCell(cellId);}
\DoxyCodeLine{363         \textcolor{comment}{// Get the "{}ID"{} of Finite Element for the given 2D Element ( Conforming/NonConforming-\/Order Finite Element : eg : it could be Conforming-\/2nd order Finite Element )}}
\DoxyCodeLine{364         FE2D elementId = Fespace-\/>GetFE2D(cellId, currentCell);}
\DoxyCodeLine{365         \textcolor{comment}{// Get the Class object for that 2d FEM Element , which has all the details like Shape functions , Nodal point locations for that location, Reference Transformation ( Affine , Bilinear )}}
\DoxyCodeLine{366         TFE2D *element = TFEDatabase2D::GetFE2D(elementId);}
\DoxyCodeLine{367         TFEDesc2D *fedesc = element-\/>GetFEDesc2D();}
\DoxyCodeLine{368         \textcolor{comment}{// Class for basis functions in 2D ( Number of basis functions ), basis function values and Derivatives}}
\DoxyCodeLine{369         TBaseFunct2D* bf = element-\/>GetBaseFunct2D();}
\DoxyCodeLine{370         \textcolor{comment}{// Get the Reference Elemet}}
\DoxyCodeLine{371         BF2DRefElements RefElement = TFEDatabase2D::GetRefElementFromFE2D(elementId);}
\DoxyCodeLine{372         \textcolor{comment}{// Get the reference Transformation -\/-\/ Affine Mapping / Bilnea Mapping of Triangle or Quadrilateral}}
\DoxyCodeLine{373         RefTrans2D referenceTransformation =  TFEDatabase2D::GetRefTrans2D\_IDFromFE2D(elementId);}
\DoxyCodeLine{374         \textcolor{comment}{// Get the number of basis functions in the Current Cell ( Number of Local DOF)}}
\DoxyCodeLine{375         \textcolor{keywordtype}{int} N\_BaseFunct = element-\/>GetN\_DOF();}
\DoxyCodeLine{376         \textcolor{comment}{// Type of Basis Function in 2D}}
\DoxyCodeLine{377         BaseFunct2D BaseFunct\_ID = element-\/>GetBaseFunct2D\_ID();}
\DoxyCodeLine{378 }
\DoxyCodeLine{379         \textcolor{comment}{// get cell measure}}
\DoxyCodeLine{380         \textcolor{keywordtype}{double} hK = currentCell-\/>GetDiameter();}
\DoxyCodeLine{381 }
\DoxyCodeLine{382         }
\DoxyCodeLine{383         \textcolor{keywordflow}{switch} (referenceTransformation)}
\DoxyCodeLine{384         \{}
\DoxyCodeLine{385             \textcolor{keywordflow}{case} QuadBilinear:}
\DoxyCodeLine{386             \{}
\DoxyCodeLine{387                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{388                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{389                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{390                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{391 }
\DoxyCodeLine{392                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{393                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadBilinear);}
\DoxyCodeLine{394                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadBilinear);                               \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{395 }
\DoxyCodeLine{396                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{397                 TFEDatabase2D::GetOrigFromRef(QuadBilinear,N\_Points2, t1,t2,  X,Y, AbsDetjk);               \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{398 }
\DoxyCodeLine{399                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{400                 TFEDatabase2D::GetOrigValues(QuadBilinear, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{401                 }
\DoxyCodeLine{402                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{403                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{404                 origvaluesD00       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);               \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{405                 origvaluesD10       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{406                 origvaluesD01       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{407                 origvaluesD20       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{408                 origvaluesD02       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{409                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{410             \}}
\DoxyCodeLine{411 }
\DoxyCodeLine{412 }
\DoxyCodeLine{413             \textcolor{keywordflow}{case} QuadAffin:}
\DoxyCodeLine{414             \{}
\DoxyCodeLine{415                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{416                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{417                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{418                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{419 }
\DoxyCodeLine{420                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{421                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadAffin);}
\DoxyCodeLine{422                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadAffin);                                  \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{423 }
\DoxyCodeLine{424                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{425                 TFEDatabase2D::GetOrigFromRef(QuadAffin,N\_Points2, t1,t2,  X,Y, AbsDetjk);   \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{426 }
\DoxyCodeLine{427                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{428                 TFEDatabase2D::GetOrigValues(QuadAffin, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{429                 }
\DoxyCodeLine{430 }
\DoxyCodeLine{431                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{432                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{433                 origvaluesD00 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);             \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{434                 origvaluesD10 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{435                 origvaluesD01 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{436                 origvaluesD20 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Points}}
\DoxyCodeLine{437                 origvaluesD02 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{438 }
\DoxyCodeLine{439                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{440             \}}
\DoxyCodeLine{441                     }
\DoxyCodeLine{442             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{443             \{}
\DoxyCodeLine{444                 cout << \textcolor{stringliteral}{"{} [ERROR] -\/ Error in File : CoeffEqn\_DO.C "{}} <<endl;}
\DoxyCodeLine{445                 cout << \textcolor{stringliteral}{"{} Unknown Reftype "{}} <<endl;}
\DoxyCodeLine{446                 cout << \textcolor{stringliteral}{"{} REF TYPE : "{}} << referenceTransformation <<endl;}
\DoxyCodeLine{447                 exit(0);}
\DoxyCodeLine{448                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{449 }
\DoxyCodeLine{450             \}}
\DoxyCodeLine{451         \}}
\DoxyCodeLine{452 }
\DoxyCodeLine{453         \textcolor{keywordtype}{int}* DOF = GlobalNumbers + BeginIndex[cellId];}
\DoxyCodeLine{454         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{455         }
\DoxyCodeLine{456         \textcolor{keywordtype}{double}* C\_Array = FeVector\_C-\/>GetValues();}
\DoxyCodeLine{457         \textcolor{keywordtype}{int} len         = FeVector\_C-\/>GetLength();}
\DoxyCodeLine{458 }
\DoxyCodeLine{459         }
\DoxyCodeLine{460 }
\DoxyCodeLine{461         \textcolor{keywordtype}{double}* C\_Array\_i = C\_Array + i\_index*len;}
\DoxyCodeLine{462 }
\DoxyCodeLine{463         }
\DoxyCodeLine{464         \textcolor{comment}{// Save Values of C at all quadrature points for I component}}
\DoxyCodeLine{465         \textcolor{keywordtype}{double} C\_i[N\_Points2];}
\DoxyCodeLine{466         \textcolor{keywordtype}{double} C\_x\_i[N\_Points2];}
\DoxyCodeLine{467         \textcolor{keywordtype}{double} C\_y\_i[N\_Points2];}
\DoxyCodeLine{468 }
\DoxyCodeLine{469         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_i[quadPt] = 0;}
\DoxyCodeLine{470         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_i[quadPt] = 0;}
\DoxyCodeLine{471         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_i[quadPt] = 0;}
\DoxyCodeLine{472         }
\DoxyCodeLine{473         }
\DoxyCodeLine{474         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{475         \{}
\DoxyCodeLine{476             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{477             \{}
\DoxyCodeLine{478                 \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{479                 C\_i[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{480                 C\_x\_i[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{481                 C\_y\_i[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{482             \}}
\DoxyCodeLine{483         \}}
\DoxyCodeLine{484         }
\DoxyCodeLine{485         \textcolor{keywordtype}{double} rhs[N\_BaseFunct];}
\DoxyCodeLine{486         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 0 ; j < N\_BaseFunct; j++) rhs[j] = 0;}
\DoxyCodeLine{487 }
\DoxyCodeLine{488         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} a = 0 ; a < N\_S ; a++)}
\DoxyCodeLine{489         \{}
\DoxyCodeLine{490             \textcolor{keywordtype}{double}* C\_Array\_a = C\_Array + i\_index*len;}
\DoxyCodeLine{491 }
\DoxyCodeLine{492             \textcolor{keywordtype}{double} C\_a[N\_Points2];}
\DoxyCodeLine{493             \textcolor{keywordtype}{double} C\_x\_a[N\_Points2];}
\DoxyCodeLine{494             \textcolor{keywordtype}{double} C\_y\_a[N\_Points2];}
\DoxyCodeLine{495 }
\DoxyCodeLine{496             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_a[quadPt] = 0;}
\DoxyCodeLine{497             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_a[quadPt] = 0;}
\DoxyCodeLine{498             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_a[quadPt] = 0;}
\DoxyCodeLine{499 }
\DoxyCodeLine{500             \textcolor{comment}{// Obtain all values for C\_a}}
\DoxyCodeLine{501             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{502             \{}
\DoxyCodeLine{503                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{504                 \{}
\DoxyCodeLine{505                     \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{506                     C\_a[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{507                     \textcolor{comment}{// C\_x\_a[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_a[globDOF];}}
\DoxyCodeLine{508                     \textcolor{comment}{// C\_y\_a[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_a[globDOF];}}
\DoxyCodeLine{509                 \}}
\DoxyCodeLine{510             \}}
\DoxyCodeLine{511             }
\DoxyCodeLine{512 }
\DoxyCodeLine{513 }
\DoxyCodeLine{514             \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{515             \textcolor{comment}{//Get Coefficients b1 and b2}}
\DoxyCodeLine{516             \textcolor{keywordtype}{double} *Param[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{517             \textcolor{keywordtype}{double} **Coeffs =  \textcolor{keyword}{new} \textcolor{keywordtype}{double}*[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{518             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < MaxN\_QuadPoints\_2D; i++)}
\DoxyCodeLine{519             \{}
\DoxyCodeLine{520                 Coeffs[i] = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[10]();}
\DoxyCodeLine{521             \}}
\DoxyCodeLine{522             }
\DoxyCodeLine{523             }
\DoxyCodeLine{524 }
\DoxyCodeLine{525             DO\_Mode\_Equation\_Coefficients(N\_Points2,X, Y,Param, Coeffs);}
\DoxyCodeLine{526             }
\DoxyCodeLine{527             \textcolor{comment}{// INner Quadrature Loop }}
\DoxyCodeLine{528             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{529             \{}
\DoxyCodeLine{530                 \textcolor{keywordtype}{double} Mult = Weights2[quadPt] * AbsDetjk[quadPt];}
\DoxyCodeLine{531                 \textcolor{keywordtype}{double}* orgD00 = origvaluesD00[quadPt];}
\DoxyCodeLine{532                 \textcolor{keywordtype}{double}* orgD10 = origvaluesD10[quadPt];}
\DoxyCodeLine{533                 \textcolor{keywordtype}{double}* orgD01 = origvaluesD01[quadPt];}
\DoxyCodeLine{534                 \textcolor{keywordtype}{double}* orgD20 = origvaluesD20[quadPt];}
\DoxyCodeLine{535                 \textcolor{keywordtype}{double}* orgD02 = origvaluesD02[quadPt];}
\DoxyCodeLine{536 }
\DoxyCodeLine{537                 \textcolor{keywordtype}{double} b1 = Coeffs[quadPt][1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{538                 \textcolor{keywordtype}{double} b2 = Coeffs[quadPt][2]; \textcolor{comment}{// b1}}
\DoxyCodeLine{539 }
\DoxyCodeLine{540                 }
\DoxyCodeLine{541                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt\_1 = 0 ; quadPt\_1 < N\_Points2; quadPt\_1++)}
\DoxyCodeLine{542                 \{}
\DoxyCodeLine{543                     val += (b1*C\_x\_i[quadPt\_1] + b2*C\_y\_i[quadPt\_1])*C\_a[quadPt\_1];}
\DoxyCodeLine{544                     val *= Mult;}
\DoxyCodeLine{545                 \}}
\DoxyCodeLine{546 }
\DoxyCodeLine{547                 val *= -\/1.0*C\_a[quadPt] ;  \textcolor{comment}{// This is Final "{}f"{}}}
\DoxyCodeLine{548 }
\DoxyCodeLine{549                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 0 ; j < N\_BaseFunct ; j++)}
\DoxyCodeLine{550                 \{}
\DoxyCodeLine{551                     rhs[j] += val * orgD00[j] * Mult;   }
\DoxyCodeLine{552                     }
\DoxyCodeLine{553                 \}}
\DoxyCodeLine{554 }
\DoxyCodeLine{555             \}}
\DoxyCodeLine{556 }
\DoxyCodeLine{557         \}}
\DoxyCodeLine{558 }
\DoxyCodeLine{559         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 0 ; j < N\_BaseFunct ; j++)}
\DoxyCodeLine{560         \{}
\DoxyCodeLine{561             \textcolor{keywordtype}{int} GlobalDOF                   = DOF[j];}
\DoxyCodeLine{562             GlobalRhs\_mode[GlobalDOF]       += rhs[j];}
\DoxyCodeLine{563         \}}
\DoxyCodeLine{564         \textcolor{comment}{// -\/-\/ }}
\DoxyCodeLine{565     \}}
\DoxyCodeLine{566 \}}
\DoxyCodeLine{567 }
\DoxyCodeLine{568 }
\DoxyCodeLine{569 }
\DoxyCodeLine{570 \textcolor{keywordtype}{void} DO\_CoEfficient(TFESpace2D *Fespace, TFEVectFunct2D *FeVector\_C\_Mode,TFEVectFunct2D* FEVector\_Phi, \textcolor{keywordtype}{int} N\_S, \textcolor{keywordtype}{int} i\_index,\textcolor{keywordtype}{int} N\_R)}
\DoxyCodeLine{571 \{}
\DoxyCodeLine{572 }
\DoxyCodeLine{573     \textcolor{keywordtype}{int} N\_Cells = Fespace-\/>GetN\_Cells();}
\DoxyCodeLine{574     TCollection* coll = Fespace-\/>GetCollection();}
\DoxyCodeLine{575 }
\DoxyCodeLine{576     \textcolor{comment}{// Get the Global DOF arrays INdex from the FE Space. }}
\DoxyCodeLine{577     \textcolor{keywordtype}{int}* GlobalNumbers = Fespace-\/>GetGlobalNumbers();}
\DoxyCodeLine{578     \textcolor{keywordtype}{int}* BeginIndex = Fespace-\/>GetBeginIndex();}
\DoxyCodeLine{579 }
\DoxyCodeLine{580     \textcolor{comment}{// -\/-\/-\/ Quadrature Formula Arrays  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{581     \textcolor{keywordtype}{int} N\_Points2;}
\DoxyCodeLine{582     \textcolor{keywordtype}{double} *Weights2, *t1, *t2;      \textcolor{comment}{// Weights -\/ Quadrature Weights array ; t1  -\/-\/ Quadrature point ( xi ) in ref coordinate ; t2 -\/  Quadrature Point ( eta ) in Ref Coordinate }}
\DoxyCodeLine{583     \textcolor{keywordtype}{bool} Needs2ndDer[1]; }
\DoxyCodeLine{584     Needs2ndDer[0] = TRUE;}
\DoxyCodeLine{585     \textcolor{keywordtype}{double} AbsDetjk[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{586     \textcolor{keywordtype}{double} X[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{587     \textcolor{keywordtype}{double} Y[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{588 }
\DoxyCodeLine{589 }
\DoxyCodeLine{590     \textcolor{comment}{// FE Values Arrays }}
\DoxyCodeLine{591     \textcolor{keywordtype}{double}** origvaluesD00;           \textcolor{comment}{// Shape function values at quadrature Points}}
\DoxyCodeLine{592     \textcolor{keywordtype}{double}** origvaluesD10;           \textcolor{comment}{// Shape Function Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{593     \textcolor{keywordtype}{double}** origvaluesD01;           \textcolor{comment}{// Shape Function Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{594     \textcolor{keywordtype}{double}** origvaluesD20;           \textcolor{comment}{// Shape Function 2nd Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{595     \textcolor{keywordtype}{double}** origvaluesD02;           \textcolor{comment}{// Shape Function 2nd Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{596 }
\DoxyCodeLine{597     \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{598     \textcolor{keywordtype}{double}* C\_Array = FeVector\_C\_Mode-\/>GetValues();}
\DoxyCodeLine{599     \textcolor{keywordtype}{int} lenMode         = FeVector\_C\_Mode-\/>GetLength();}
\DoxyCodeLine{600 }
\DoxyCodeLine{601 }
\DoxyCodeLine{602     \textcolor{keywordtype}{double}* Phi\_Array = FEVector\_Phi-\/>GetValues();}
\DoxyCodeLine{603     \textcolor{keywordtype}{double}* Phi\_Old = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[N\_R*N\_S]();}
\DoxyCodeLine{604     memcpy(Phi\_Old,Phi\_Array,N\_R*N\_S*SizeOfDouble);}
\DoxyCodeLine{605     \textcolor{keywordtype}{int} lenPhi         = FEVector\_Phi-\/>GetLength();}
\DoxyCodeLine{606     cout << \textcolor{stringliteral}{"{}************** Length of Phi = "{}} << lenPhi << endl;}
\DoxyCodeLine{607     \textcolor{keywordtype}{double}* phi\_New = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[lenPhi]();}
\DoxyCodeLine{608     \textcolor{keywordtype}{double}* C\_Array\_i = C\_Array + i\_index*lenMode;}
\DoxyCodeLine{609     \textcolor{comment}{// double* phi\_Array\_i = Phi\_Array + i\_index*lenMode; ??}}
\DoxyCodeLine{610     \textcolor{keywordtype}{double}* phi\_Array\_i = Phi\_Array + i\_index*lenPhi;}
\DoxyCodeLine{611     \textcolor{keywordtype}{double}* phi\_Old\_i = Phi\_Old + i\_index*lenPhi;}
\DoxyCodeLine{612 }
\DoxyCodeLine{613 }
\DoxyCodeLine{614 }
\DoxyCodeLine{615 }
\DoxyCodeLine{616     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} cellId = 0; cellId < 1; cellId++)}
\DoxyCodeLine{617     \{}
\DoxyCodeLine{618         TBaseCell* currentCell = coll-\/>GetCell(cellId);}
\DoxyCodeLine{619         \textcolor{comment}{// Get the "{}ID"{} of Finite Element for the given 2D Element ( Conforming/NonConforming-\/Order Finite Element : eg : it could be Conforming-\/2nd order Finite Element )}}
\DoxyCodeLine{620         FE2D elementId = Fespace-\/>GetFE2D(cellId, currentCell);}
\DoxyCodeLine{621         \textcolor{comment}{// Get the Class object for that 2d FEM Element , which has all the details like Shape functions , Nodal point locations for that location, Reference Transformation ( Affine , Bilinear )}}
\DoxyCodeLine{622         TFE2D *element = TFEDatabase2D::GetFE2D(elementId);}
\DoxyCodeLine{623         TFEDesc2D *fedesc = element-\/>GetFEDesc2D();}
\DoxyCodeLine{624         \textcolor{comment}{// Class for basis functions in 2D ( Number of basis functions ), basis function values and Derivatives}}
\DoxyCodeLine{625         TBaseFunct2D* bf = element-\/>GetBaseFunct2D();}
\DoxyCodeLine{626         \textcolor{comment}{// Get the Reference Elemet}}
\DoxyCodeLine{627         BF2DRefElements RefElement = TFEDatabase2D::GetRefElementFromFE2D(elementId);}
\DoxyCodeLine{628         \textcolor{comment}{// Get the reference Transformation -\/-\/ Affine Mapping / Bilnea Mapping of Triangle or Quadrilateral}}
\DoxyCodeLine{629         RefTrans2D referenceTransformation =  TFEDatabase2D::GetRefTrans2D\_IDFromFE2D(elementId);}
\DoxyCodeLine{630         \textcolor{comment}{// Get the number of basis functions in the Current Cell ( Number of Local DOF)}}
\DoxyCodeLine{631         \textcolor{keywordtype}{int} N\_BaseFunct = element-\/>GetN\_DOF();}
\DoxyCodeLine{632         \textcolor{comment}{// Type of Basis Function in 2D}}
\DoxyCodeLine{633         BaseFunct2D BaseFunct\_ID = element-\/>GetBaseFunct2D\_ID();}
\DoxyCodeLine{634 }
\DoxyCodeLine{635         \textcolor{comment}{// get cell measure}}
\DoxyCodeLine{636         \textcolor{keywordtype}{double} hK = currentCell-\/>GetDiameter();}
\DoxyCodeLine{637 }
\DoxyCodeLine{638         }
\DoxyCodeLine{639         \textcolor{keywordflow}{switch} (referenceTransformation)}
\DoxyCodeLine{640         \{}
\DoxyCodeLine{641             \textcolor{keywordflow}{case} QuadBilinear:}
\DoxyCodeLine{642             \{}
\DoxyCodeLine{643                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{644                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{645                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{646                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{647 }
\DoxyCodeLine{648                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{649                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadBilinear);}
\DoxyCodeLine{650                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadBilinear);                               \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{651 }
\DoxyCodeLine{652                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{653                 TFEDatabase2D::GetOrigFromRef(QuadBilinear,N\_Points2, t1,t2,  X,Y, AbsDetjk);               \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{654 }
\DoxyCodeLine{655                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{656                 TFEDatabase2D::GetOrigValues(QuadBilinear, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{657                 }
\DoxyCodeLine{658                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{659                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{660                 origvaluesD00       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);               \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{661                 origvaluesD10       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{662                 origvaluesD01       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{663                 origvaluesD20       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{664                 origvaluesD02       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{665                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{666             \}}
\DoxyCodeLine{667 }
\DoxyCodeLine{668 }
\DoxyCodeLine{669             \textcolor{keywordflow}{case} QuadAffin:}
\DoxyCodeLine{670             \{}
\DoxyCodeLine{671                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{672                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{673                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{674                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{675 }
\DoxyCodeLine{676                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{677                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadAffin);}
\DoxyCodeLine{678                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadAffin);                                  \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{679 }
\DoxyCodeLine{680                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{681                 TFEDatabase2D::GetOrigFromRef(QuadAffin,N\_Points2, t1,t2,  X,Y, AbsDetjk);   \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{682 }
\DoxyCodeLine{683                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{684                 TFEDatabase2D::GetOrigValues(QuadAffin, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{685                 }
\DoxyCodeLine{686 }
\DoxyCodeLine{687                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{688                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{689                 origvaluesD00 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);             \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{690                 origvaluesD10 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{691                 origvaluesD01 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{692                 origvaluesD20 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Points}}
\DoxyCodeLine{693                 origvaluesD02 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{694 }
\DoxyCodeLine{695                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{696             \}}
\DoxyCodeLine{697                     }
\DoxyCodeLine{698             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{699             \{}
\DoxyCodeLine{700                 cout << \textcolor{stringliteral}{"{} [ERROR] -\/ Error in File : CoeffEqn\_DO.C "{}} <<endl;}
\DoxyCodeLine{701                 cout << \textcolor{stringliteral}{"{} Unknown Reftype "{}} <<endl;}
\DoxyCodeLine{702                 cout << \textcolor{stringliteral}{"{} REF TYPE : "{}} << referenceTransformation <<endl;}
\DoxyCodeLine{703                 exit(0);}
\DoxyCodeLine{704                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{705 }
\DoxyCodeLine{706             \}}
\DoxyCodeLine{707         \}}
\DoxyCodeLine{708 }
\DoxyCodeLine{709         \textcolor{keywordtype}{int}* DOF = GlobalNumbers + BeginIndex[cellId];}
\DoxyCodeLine{710         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{711 }
\DoxyCodeLine{712         \textcolor{comment}{// Save Values of C at all quadrature points for I component}}
\DoxyCodeLine{713         \textcolor{keywordtype}{double} C\_i[N\_Points2];}
\DoxyCodeLine{714         \textcolor{keywordtype}{double} C\_x\_i[N\_Points2];}
\DoxyCodeLine{715         \textcolor{keywordtype}{double} C\_y\_i[N\_Points2];}
\DoxyCodeLine{716 }
\DoxyCodeLine{717 }
\DoxyCodeLine{718         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_i[quadPt] = 0;}
\DoxyCodeLine{719         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_i[quadPt] = 0;}
\DoxyCodeLine{720         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_i[quadPt] = 0;}
\DoxyCodeLine{721 }
\DoxyCodeLine{722         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{723         \{}
\DoxyCodeLine{724             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{725             \{}
\DoxyCodeLine{726                 \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{727                 C\_i[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{728                 \textcolor{comment}{// C\_x\_i[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_i[globDOF];}}
\DoxyCodeLine{729                 \textcolor{comment}{// C\_y\_i[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_i[globDOF];}}
\DoxyCodeLine{730             \}}
\DoxyCodeLine{731         \}}
\DoxyCodeLine{732 }
\DoxyCodeLine{733 }
\DoxyCodeLine{734         \textcolor{comment}{// for ( int j = 0 ; j < N\_BaseFunct; j++) rhs[j] = 0;}}
\DoxyCodeLine{735 }
\DoxyCodeLine{736         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} a = 0 ; a < N\_S ; a++)}
\DoxyCodeLine{737         \{}
\DoxyCodeLine{738             \textcolor{keywordtype}{double}* C\_Array\_a = C\_Array + a*lenMode;}
\DoxyCodeLine{739             \textcolor{comment}{// double* phi\_Array\_a = Phi\_Array + a*lenMode;??}}
\DoxyCodeLine{740             \textcolor{keywordtype}{double}* phi\_Array\_a = Phi\_Array + a*lenPhi;}
\DoxyCodeLine{741 }
\DoxyCodeLine{742             \textcolor{keywordtype}{double} C\_a[N\_Points2];}
\DoxyCodeLine{743             \textcolor{keywordtype}{double} C\_x\_a[N\_Points2];}
\DoxyCodeLine{744             \textcolor{keywordtype}{double} C\_y\_a[N\_Points2];}
\DoxyCodeLine{745 }
\DoxyCodeLine{746             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_a[quadPt] = 0;}
\DoxyCodeLine{747             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_a[quadPt] = 0;}
\DoxyCodeLine{748             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_a[quadPt] = 0;}
\DoxyCodeLine{749 }
\DoxyCodeLine{750 }
\DoxyCodeLine{751             \textcolor{comment}{// Obtain all values for C\_a}}
\DoxyCodeLine{752             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{753             \{}
\DoxyCodeLine{754                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{755                 \{}
\DoxyCodeLine{756                     \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{757                     C\_a[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{758                     C\_x\_a[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{759                     C\_y\_a[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{760                 \}}
\DoxyCodeLine{761             \}}
\DoxyCodeLine{762             }
\DoxyCodeLine{763 }
\DoxyCodeLine{764 }
\DoxyCodeLine{765             \textcolor{comment}{//Get Coefficients b1 and b2}}
\DoxyCodeLine{766             \textcolor{keywordtype}{double} *Param[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{767             \textcolor{keywordtype}{double} **Coeffs =  \textcolor{keyword}{new} \textcolor{keywordtype}{double}*[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{768             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < MaxN\_QuadPoints\_2D; i++)}
\DoxyCodeLine{769             \{}
\DoxyCodeLine{770                 Coeffs[i] = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[10]();}
\DoxyCodeLine{771             \}}
\DoxyCodeLine{772             }
\DoxyCodeLine{773 }
\DoxyCodeLine{774             DO\_Mode\_Equation\_Coefficients(N\_Points2,X, Y,Param, Coeffs);}
\DoxyCodeLine{775             }
\DoxyCodeLine{776             \textcolor{comment}{// INner Quadrature Loop }}
\DoxyCodeLine{777             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{778             \{}
\DoxyCodeLine{779                 \textcolor{keywordtype}{double} Mult = Weights2[quadPt] * AbsDetjk[quadPt];}
\DoxyCodeLine{780                 \textcolor{keywordtype}{double}* orgD00 = origvaluesD00[quadPt];}
\DoxyCodeLine{781                 \textcolor{keywordtype}{double}* orgD10 = origvaluesD10[quadPt];}
\DoxyCodeLine{782                 \textcolor{keywordtype}{double}* orgD01 = origvaluesD01[quadPt];}
\DoxyCodeLine{783                 \textcolor{keywordtype}{double}* orgD20 = origvaluesD20[quadPt];}
\DoxyCodeLine{784                 \textcolor{keywordtype}{double}* orgD02 = origvaluesD02[quadPt];}
\DoxyCodeLine{785 }
\DoxyCodeLine{786                 \textcolor{keywordtype}{double} b1 = Coeffs[quadPt][1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{787                 \textcolor{keywordtype}{double} b2 = Coeffs[quadPt][2]; \textcolor{comment}{// b1}}
\DoxyCodeLine{788                 \textcolor{comment}{// double b1 = 1;}}
\DoxyCodeLine{789                 \textcolor{comment}{// double b2 = 1;}}
\DoxyCodeLine{790 }
\DoxyCodeLine{791                 val += (b1*C\_x\_a[quadPt] + b2*C\_y\_a[quadPt])*C\_i[quadPt];}
\DoxyCodeLine{792                 val *= Mult;}
\DoxyCodeLine{793 }
\DoxyCodeLine{794             \}}
\DoxyCodeLine{795     }
\DoxyCodeLine{796 }
\DoxyCodeLine{797             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < lenPhi ; i++)}
\DoxyCodeLine{798             \{}
\DoxyCodeLine{799                 phi\_New[i] += val*phi\_Array\_a[i]*-\/1.0;}
\DoxyCodeLine{800             \}}
\DoxyCodeLine{801 }
\DoxyCodeLine{802         \}}
\DoxyCodeLine{803 }
\DoxyCodeLine{804             }
\DoxyCodeLine{805         }
\DoxyCodeLine{806     \}}
\DoxyCodeLine{807 }
\DoxyCodeLine{808     \textcolor{keywordtype}{double} timeStep = TDatabase::TimeDB-\/>CURRENTTIMESTEPLENGTH;}
\DoxyCodeLine{809     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < lenPhi; i++)}
\DoxyCodeLine{810     \{}
\DoxyCodeLine{811         phi\_Array\_i[i] += phi\_Old\_i[i]+ timeStep*phi\_New[i];}
\DoxyCodeLine{812     \}}
\DoxyCodeLine{813 }
\DoxyCodeLine{814     \textcolor{keyword}{delete}[] phi\_New;}
\DoxyCodeLine{815 }
\DoxyCodeLine{816 \}}
\DoxyCodeLine{817 }

\end{DoxyCode}
