\hypertarget{linear__advection__do__test_8h_source}{}\doxysection{linear\+\_\+advection\+\_\+do\+\_\+test.\+h}
\label{linear__advection__do__test_8h_source}\index{Examples/DO\_UQ/linear\_advection\_do\_test.h@{Examples/DO\_UQ/linear\_advection\_do\_test.h}}
\mbox{\hyperlink{linear__advection__do__test_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{19 \textcolor{comment}{// ===========================================================================//}}
\DoxyCodeLine{20 \textcolor{comment}{//  Dynamically Orthogonal Field Equation Solution of Linear Advection Problem //}}
\DoxyCodeLine{21 \textcolor{comment}{// ===========================================================================//}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{comment}{// =======================================================================}}
\DoxyCodeLine{24 \textcolor{comment}{//}}
\DoxyCodeLine{25 \textcolor{comment}{// Purpose:     Example file for solving the set of dynamically orthogonal field}}
\DoxyCodeLine{26 \textcolor{comment}{//              equations for linear advection.  }}
\DoxyCodeLine{27 \textcolor{comment}{//              Features included in this example file -\/ }}
\DoxyCodeLine{28 \textcolor{comment}{//              1. Definition of boundary conditions, boundary values,}}
\DoxyCodeLine{29 \textcolor{comment}{//                 initial condition and bilinear coefficients}}
\DoxyCodeLine{30 \textcolor{comment}{//              2. Assembly functions for Mean Equation, Mode Equation}}
\DoxyCodeLine{31 \textcolor{comment}{//                 and Coefficient Equation}}
\DoxyCodeLine{32 \textcolor{comment}{//              3. Assembly function for RHS of Mode Equation}}
\DoxyCodeLine{33 \textcolor{comment}{//}}
\DoxyCodeLine{34 \textcolor{comment}{// Authors:      Sashikumaar Ganesan, Thivin Anandh, Divij Ghose}}
\DoxyCodeLine{35 \textcolor{comment}{//}}
\DoxyCodeLine{36 \textcolor{comment}{// History:     1> First iteration implemented on 18.03.2022}}
\DoxyCodeLine{37 \textcolor{comment}{//              2> Bug fixes on 24.03.2022}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{comment}{// =======================================================================}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 }
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{preprocessor}{\#include <MacroCell.h>}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#include <IsoBoundEdge.h>}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#include <IsoInterfaceJoint.h>}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}}}
\DoxyCodeLine{48 \{}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#include <gridgen.h>}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51     \textcolor{keywordtype}{void} triangulate(\textcolor{keywordtype}{char} *, \textcolor{keyword}{struct} triangulateio *,}
\DoxyCodeLine{52                      \textcolor{keyword}{struct} triangulateio *, \textcolor{keyword}{struct} triangulateio *);}
\DoxyCodeLine{53 \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{comment}{// Include files related to the cell looping for the RHS filling part.}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{preprocessor}{\#include <Domain.h>}}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#include <Database.h>}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#include <FEDatabase2D.h>}}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#include <LinAlg.h>}}
\DoxyCodeLine{61 \textcolor{preprocessor}{\#include <FESpace2D.h>}}
\DoxyCodeLine{62 \textcolor{preprocessor}{\#include <SystemTNSE2D.h>}}
\DoxyCodeLine{63 \textcolor{preprocessor}{\#include <SquareStructure2D.h>}}
\DoxyCodeLine{64 \textcolor{preprocessor}{\#include <Structure2D.h>}}
\DoxyCodeLine{65 \textcolor{preprocessor}{\#include <Output2D.h>}}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#include <CD2DErrorEstimator.h>}}
\DoxyCodeLine{67 \textcolor{preprocessor}{\#include <MainUtilities.h>}}
\DoxyCodeLine{68 \textcolor{comment}{// \#include <TimeUtilities.h>}}
\DoxyCodeLine{69 \textcolor{preprocessor}{\#include <TNSE2D\_ParamRout.h>}}
\DoxyCodeLine{70 \textcolor{preprocessor}{\#include <TimeDiscRout.h>}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{73 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{74 \textcolor{preprocessor}{\#include <MooNMD\_Io.h>}}
\DoxyCodeLine{75 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{76 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{77 \textcolor{preprocessor}{\#include <sys/stat.h>}}
\DoxyCodeLine{78 \textcolor{preprocessor}{\#include <sys/types.h>}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{preprocessor}{\#include <QuadAffin.h>}}
\DoxyCodeLine{81 \textcolor{preprocessor}{\#include <QuadBilinear.h>}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{comment}{//========================================================================//}}
\DoxyCodeLine{84 \textcolor{comment}{//                              Example File                              //}}
\DoxyCodeLine{85 \textcolor{comment}{// =======================================================================//}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \textcolor{preprocessor}{\#define \_\_SIN3\_\_}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{keywordtype}{void} ExampleFile()}
\DoxyCodeLine{90 \{}
\DoxyCodeLine{91     OutPut(\textcolor{stringliteral}{"{}Example: Linear Advection -\/ Dynamically Orthogonal Field Equation Solution"{}} << endl);}
\DoxyCodeLine{92 \}}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 \textcolor{comment}{// exact solution}}
\DoxyCodeLine{95 \textcolor{keywordtype}{void} Exact(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} y, \textcolor{keywordtype}{double} *values)}
\DoxyCodeLine{96 \{}
\DoxyCodeLine{97     \textcolor{keywordtype}{double} t;}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{100 }
\DoxyCodeLine{101     values[0] = exp(t) * (sin(2 * Pi * x) * sin(2 * Pi * y));}
\DoxyCodeLine{102     values[1] = exp(t) * 2 * Pi * cos(2 * Pi * x) * sin(2 * Pi * y);}
\DoxyCodeLine{103     values[2] = exp(t) * 2 * Pi * sin(2 * Pi * x) * cos(2 * Pi * y);}
\DoxyCodeLine{104     values[3] = 0;}
\DoxyCodeLine{105 \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{comment}{// kind of boundary condition (for FE space needed)}}
\DoxyCodeLine{108 \textcolor{keywordtype}{void} BoundCondition(\textcolor{keywordtype}{int} BdComp, \textcolor{keywordtype}{double} t, BoundCond \&cond)}
\DoxyCodeLine{109 \{}
\DoxyCodeLine{110     \textcolor{comment}{//  cond = NEUMANN;}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112     \textcolor{comment}{//  if(BdComp == 1 || BdComp == 3 || BdComp == 2 )}}
\DoxyCodeLine{113     \textcolor{comment}{//  \{}}
\DoxyCodeLine{114     cond = DIRICHLET;}
\DoxyCodeLine{115     \textcolor{comment}{//  \}}}
\DoxyCodeLine{116 \}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \textcolor{comment}{// value of boundary condition}}
\DoxyCodeLine{119 \textcolor{keywordtype}{void} BoundValue(\textcolor{keywordtype}{int} BdComp, \textcolor{keywordtype}{double} Param, \textcolor{keywordtype}{double} \&value)}
\DoxyCodeLine{120 \{}
\DoxyCodeLine{121     value = 0;}
\DoxyCodeLine{122 \}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 \textcolor{comment}{// initial conditon}}
\DoxyCodeLine{125 \textcolor{keywordtype}{void} InitialCondition(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} y, \textcolor{keywordtype}{double} *values)}
\DoxyCodeLine{126 \{}
\DoxyCodeLine{127     \textcolor{keywordtype}{double} t,val;}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{130     \textcolor{comment}{// values[0] = exp(t)*(sin(2*Pi*x)*sin(2*Pi*y));}}
\DoxyCodeLine{131     \textcolor{comment}{// double val\_x = exp(-\/1.0* ( 1.0 / ( 1 -\/ pow((2*x-\/1),4) ) ));}}
\DoxyCodeLine{132     \textcolor{comment}{// double val\_y = exp(-\/1.0* ( 1.0 / ( 1 -\/ pow((2*y-\/1),4) ) ));}}
\DoxyCodeLine{133     \textcolor{comment}{// values[0] = val\_x*val\_y;}}
\DoxyCodeLine{134     }
\DoxyCodeLine{135     \textcolor{comment}{// double r = 0.1;}}
\DoxyCodeLine{136     \textcolor{comment}{// double centerx = 0.5;    }}
\DoxyCodeLine{137     \textcolor{comment}{// double centery = 0.5;}}
\DoxyCodeLine{138     \textcolor{comment}{// x = x -\/ centerx;}}
\DoxyCodeLine{139     \textcolor{comment}{// y = y -\/ centery; }}
\DoxyCodeLine{140     \textcolor{comment}{// double len = pow((x*x + y*y),0.5);}}
\DoxyCodeLine{141     \textcolor{comment}{// if( abs(x) < r \&\& abs(y) < r)}}
\DoxyCodeLine{142     \textcolor{comment}{// \{}}
\DoxyCodeLine{143     \textcolor{comment}{//  val = 1;}}
\DoxyCodeLine{144     \textcolor{comment}{// \}}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146     \textcolor{comment}{// else}}
\DoxyCodeLine{147     \textcolor{comment}{//  val = 0;}}
\DoxyCodeLine{148 }
\DoxyCodeLine{149     \textcolor{comment}{// values[0] = val;}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 \textcolor{keywordtype}{void} BilinearCoeffs(\textcolor{keywordtype}{int} n\_points, \textcolor{keywordtype}{double} *X, \textcolor{keywordtype}{double} *Y,}
\DoxyCodeLine{154         \textcolor{keywordtype}{double} **parameters, \textcolor{keywordtype}{double} **coeffs)}
\DoxyCodeLine{155 \{}
\DoxyCodeLine{156   \textcolor{keywordtype}{double} eps=1/TDatabase::ParamDB-\/>PE\_NR;}
\DoxyCodeLine{157   \textcolor{keywordtype}{double} b1=1, b2=-\/1, c=1;}
\DoxyCodeLine{158   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{159   \textcolor{keywordtype}{double} *coeff;}
\DoxyCodeLine{160   \textcolor{keywordtype}{double} x, y;}
\DoxyCodeLine{161   \textcolor{keywordtype}{double} t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{162 }
\DoxyCodeLine{163   \textcolor{keywordflow}{for}(i=0;i<n\_points;i++)}
\DoxyCodeLine{164   \{}
\DoxyCodeLine{165     coeff = coeffs[i];}
\DoxyCodeLine{166     }
\DoxyCodeLine{167     x = X[i];}
\DoxyCodeLine{168     y = Y[i];}
\DoxyCodeLine{169 }
\DoxyCodeLine{170     coeff[0] = 0;}
\DoxyCodeLine{171     coeff[1] = -\/sin(t)*0.2;}
\DoxyCodeLine{172     coeff[2] = cos(t)*0.2;}
\DoxyCodeLine{173     coeff[3] = 0;}
\DoxyCodeLine{174 }
\DoxyCodeLine{175     coeff[4] = 0.0;}
\DoxyCodeLine{176   \}}
\DoxyCodeLine{177 \}}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \textcolor{keywordtype}{void} DO\_Mean\_Equation\_Coefficients(\textcolor{keywordtype}{int} n\_points, \textcolor{keywordtype}{double} *X, \textcolor{keywordtype}{double} *Y,}
\DoxyCodeLine{181                                    \textcolor{keywordtype}{double} **parameters, \textcolor{keywordtype}{double} **coeffs)}
\DoxyCodeLine{182 \{}
\DoxyCodeLine{183     \textcolor{keywordtype}{double} eps = 1 / TDatabase::ParamDB-\/>PE\_NR;}
\DoxyCodeLine{184     \textcolor{keywordtype}{double} b1 = 1, b2 = -\/1, c = 1;}
\DoxyCodeLine{185     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{186     \textcolor{keywordtype}{double} *coeff;}
\DoxyCodeLine{187     \textcolor{keywordtype}{double} x, y;}
\DoxyCodeLine{188     \textcolor{keywordtype}{double} t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{189 }
\DoxyCodeLine{190     \textcolor{keywordflow}{for} (i = 0; i < n\_points; i++)}
\DoxyCodeLine{191     \{}
\DoxyCodeLine{192         coeff = coeffs[i];}
\DoxyCodeLine{193 }
\DoxyCodeLine{194         x = X[i];}
\DoxyCodeLine{195         y = Y[i];}
\DoxyCodeLine{196 }
\DoxyCodeLine{197         coeff[0] = 0;}
\DoxyCodeLine{198         coeff[1] = -\/sin(t)*0.2;}
\DoxyCodeLine{199         coeff[2] = cos(t)*0.2;}
\DoxyCodeLine{200         coeff[3] = 0;}
\DoxyCodeLine{201 }
\DoxyCodeLine{202         coeff[4] = 0.0;}
\DoxyCodeLine{203     \}}
\DoxyCodeLine{204 \}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206 }
\DoxyCodeLine{207 }
\DoxyCodeLine{208 \textcolor{keywordtype}{void} DO\_Mode\_Equation\_Coefficients(\textcolor{keywordtype}{int} n\_points, \textcolor{keywordtype}{double} *X, \textcolor{keywordtype}{double} *Y,}
\DoxyCodeLine{209                                    \textcolor{keywordtype}{double} **parameters, \textcolor{keywordtype}{double} **coeffs)}
\DoxyCodeLine{210 \{}
\DoxyCodeLine{211     \textcolor{keywordtype}{double} eps = 1 / TDatabase::ParamDB-\/>PE\_NR;}
\DoxyCodeLine{212     \textcolor{keywordtype}{double} b1 = 1, b2 = -\/1, c = 1;}
\DoxyCodeLine{213     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{214     \textcolor{keywordtype}{double} *coeff;}
\DoxyCodeLine{215     \textcolor{keywordtype}{double} x, y;}
\DoxyCodeLine{216     \textcolor{keywordtype}{double} t = TDatabase::TimeDB-\/>CURRENTTIME;}
\DoxyCodeLine{217 }
\DoxyCodeLine{218     \textcolor{keywordflow}{for} (i = 0; i < n\_points; i++)}
\DoxyCodeLine{219     \{}
\DoxyCodeLine{220         coeff = coeffs[i];}
\DoxyCodeLine{221 }
\DoxyCodeLine{222         x = X[i];}
\DoxyCodeLine{223         y = Y[i];}
\DoxyCodeLine{224 }
\DoxyCodeLine{225         coeff[0] = 0;}
\DoxyCodeLine{226         coeff[1] = -\/sin(t)*0.2;}
\DoxyCodeLine{227     coeff[2] = cos(t)*0.2;}
\DoxyCodeLine{228         coeff[3] = 0;}
\DoxyCodeLine{229 }
\DoxyCodeLine{230         coeff[4] = 0.0;}
\DoxyCodeLine{231     \}}
\DoxyCodeLine{232 \}}
\DoxyCodeLine{233 }
\DoxyCodeLine{234 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{235 \textcolor{comment}{// ASSEMBLY FUNCTION}}
\DoxyCodeLine{236 \textcolor{comment}{// This fucntion will be called for Every Quadrature Point inside a Cell for Local Assembly}}
\DoxyCodeLine{237 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{253 \textcolor{comment}{}\textcolor{keywordtype}{void} \mbox{\hyperlink{linear__advection__do__test_8h_aeeed0090e62327af95811c480240e08a}{DO\_Mean\_Equation\_Assembly}}(\textcolor{keywordtype}{double} quad\_wt, \textcolor{keywordtype}{double} *coeff, \textcolor{keywordtype}{double} *param,}
\DoxyCodeLine{254                                \textcolor{keywordtype}{double} hK, \textcolor{keywordtype}{double} **derivatives, \textcolor{keywordtype}{int} *N\_BaseFuncts, \textcolor{keywordtype}{double} ***LocMatrices, \textcolor{keywordtype}{double} **LocRhs)}
\DoxyCodeLine{255 \{}
\DoxyCodeLine{256 }
\DoxyCodeLine{257     \textcolor{comment}{// The below values N\_x, N\_y , etc are ARRAY of Values}}
\DoxyCodeLine{258     \textcolor{comment}{// Which provides Value of a Particular Shape function or its derivative ( Based on a DOF )}}
\DoxyCodeLine{259     \textcolor{comment}{// at the given Quadrature POint.}}
\DoxyCodeLine{260     \textcolor{comment}{// Here the Size of the Array is equal to the NUmber of DOF in the cell}}
\DoxyCodeLine{261 }
\DoxyCodeLine{262     \textcolor{comment}{// For Eg : Orig0[1]  gives the derivative of Shape Function number 1 ( Shape function of DOF 1 ) w.r.t x}}
\DoxyCodeLine{263     \textcolor{comment}{// at the given Quadrature Point.}}
\DoxyCodeLine{264     \textcolor{comment}{// Take these values based on the MULTIINDEX DERIVATIVE}}
\DoxyCodeLine{265     \textcolor{keywordtype}{double} *N = derivatives[0];}
\DoxyCodeLine{266     \textcolor{keywordtype}{double} *Nx = derivatives[1];}
\DoxyCodeLine{267     \textcolor{keywordtype}{double} *Ny = derivatives[2];}
\DoxyCodeLine{268 }
\DoxyCodeLine{269 }
\DoxyCodeLine{270 }
\DoxyCodeLine{271     \textcolor{keywordtype}{double} **A11, *F1;}
\DoxyCodeLine{272     \textcolor{comment}{// double val = 0.0;}}
\DoxyCodeLine{273 }
\DoxyCodeLine{274     A11 = LocMatrices[0]; \textcolor{comment}{// Local Stiffenss matrix}}
\DoxyCodeLine{275 }
\DoxyCodeLine{276     F1 = LocRhs[0];}
\DoxyCodeLine{277 }
\DoxyCodeLine{278     \textcolor{keywordtype}{double} c0 = coeff[0]; \textcolor{comment}{// nu}}
\DoxyCodeLine{279     \textcolor{keywordtype}{double} b1 = coeff[1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{280     \textcolor{keywordtype}{double} b2 = coeff[2]; \textcolor{comment}{// b2}}
\DoxyCodeLine{281     \textcolor{keywordtype}{double} c = coeff[3];  \textcolor{comment}{// c}}
\DoxyCodeLine{282     \textcolor{keywordtype}{double} f = coeff[4];  \textcolor{comment}{// f}}
\DoxyCodeLine{283 }
\DoxyCodeLine{284     \textcolor{keywordtype}{int} N\_DOF\_perCell = N\_BaseFuncts[0];}
\DoxyCodeLine{285 }
\DoxyCodeLine{286     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < N\_DOF\_perCell; i++) \textcolor{comment}{// Test}}
\DoxyCodeLine{287     \{}
\DoxyCodeLine{288         \textcolor{comment}{// Assemble RHS}}
\DoxyCodeLine{289         F1[i] = 0.0; \textcolor{comment}{// TO DO}}
\DoxyCodeLine{290         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{291         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < N\_DOF\_perCell; j++) \textcolor{comment}{// Ansatz}}
\DoxyCodeLine{292         \{}
\DoxyCodeLine{293 }
\DoxyCodeLine{294             val += -\/1.0*(b1 * Nx[j] + b2 * Ny[j]) * N[i]; \textcolor{comment}{//   TO DO}}
\DoxyCodeLine{295             \textcolor{comment}{// val  +=  c0*((Nx[j] * Nx[i])   + (Ny[j] * Ny[i]) );//???}}
\DoxyCodeLine{296             \textcolor{comment}{// val  +=  c*N[i]*N[j];}}
\DoxyCodeLine{297 }
\DoxyCodeLine{298             A11[i][j] += val * quad\_wt;}
\DoxyCodeLine{299         \} \textcolor{comment}{// endfor j}}
\DoxyCodeLine{300     \}     \textcolor{comment}{// endfor i}}
\DoxyCodeLine{301 \}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{304 \textcolor{comment}{// ASSEMBLY FUNCTION}}
\DoxyCodeLine{305 \textcolor{comment}{// This fucntion will be called for Every Quadrature Point inside a Cell for Local Assembly}}
\DoxyCodeLine{306 \textcolor{comment}{// ======================================================================}}
\DoxyCodeLine{307 \textcolor{keywordtype}{void} DO\_Mode\_Equation\_Assembly(\textcolor{keywordtype}{double} quad\_wt, \textcolor{keywordtype}{double} *coeff, \textcolor{keywordtype}{double} *param,}
\DoxyCodeLine{308                                \textcolor{keywordtype}{double} hK, \textcolor{keywordtype}{double} **derivatives, \textcolor{keywordtype}{int} *N\_BaseFuncts, \textcolor{keywordtype}{double} ***LocMatrices, \textcolor{keywordtype}{double} **LocRhs)}
\DoxyCodeLine{309 \{}
\DoxyCodeLine{310 }
\DoxyCodeLine{311     \textcolor{comment}{// The below values N\_x, N\_y , etc are ARRAY of Values}}
\DoxyCodeLine{312     \textcolor{comment}{// Which provides Value of a Particular Shape function or its derivative ( Based on a DOF )}}
\DoxyCodeLine{313     \textcolor{comment}{// at the given Quadrature POint.}}
\DoxyCodeLine{314     \textcolor{comment}{// Here the Size of the Array is equal to the NUmber of DOF in the cell}}
\DoxyCodeLine{315 }
\DoxyCodeLine{316     \textcolor{comment}{// For Eg : Orig0[1]  gives the derivative of Shape Function number 1 ( Shape function of DOF 1 ) w.r.t x}}
\DoxyCodeLine{317     \textcolor{comment}{// at the given Quadrature Point.}}
\DoxyCodeLine{318     \textcolor{comment}{// Take these values based on the MULTIINDEX DERIVATIVE}}
\DoxyCodeLine{319     \textcolor{keywordtype}{double} *N = derivatives[0];}
\DoxyCodeLine{320     \textcolor{keywordtype}{double} *Nx = derivatives[1];}
\DoxyCodeLine{321     \textcolor{keywordtype}{double} *Ny = derivatives[2];}
\DoxyCodeLine{322 }
\DoxyCodeLine{323     \textcolor{keywordtype}{double} **A11, *F1;}
\DoxyCodeLine{324     \textcolor{keywordtype}{double} val = 0.;}
\DoxyCodeLine{325 }
\DoxyCodeLine{326     A11 = LocMatrices[0]; \textcolor{comment}{// Local Stiffenss matrix}}
\DoxyCodeLine{327 }
\DoxyCodeLine{328     F1 = LocRhs[0];}
\DoxyCodeLine{329 }
\DoxyCodeLine{330     \textcolor{keywordtype}{double} c0 = coeff[0]; \textcolor{comment}{// nu}}
\DoxyCodeLine{331     \textcolor{keywordtype}{double} b1 = coeff[1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{332     \textcolor{keywordtype}{double} b2 = coeff[2]; \textcolor{comment}{// b2}}
\DoxyCodeLine{333     \textcolor{keywordtype}{double} c = coeff[3];  \textcolor{comment}{// c}}
\DoxyCodeLine{334     \textcolor{keywordtype}{double} f = coeff[4];  \textcolor{comment}{// f}}
\DoxyCodeLine{335 }
\DoxyCodeLine{336     \textcolor{keywordtype}{int} N\_DOF\_perCell = N\_BaseFuncts[0];}
\DoxyCodeLine{337 }
\DoxyCodeLine{338     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < N\_DOF\_perCell; i++) \textcolor{comment}{// Test}}
\DoxyCodeLine{339     \{}
\DoxyCodeLine{340         \textcolor{comment}{// Assemble RHS}}
\DoxyCodeLine{341         F1[i] = 0.0; \textcolor{comment}{// TO DO}}
\DoxyCodeLine{342         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{343         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < N\_DOF\_perCell; j++) \textcolor{comment}{// Ansatz}}
\DoxyCodeLine{344         \{}
\DoxyCodeLine{345 \textcolor{comment}{// double val = 0;}}
\DoxyCodeLine{346             val += -\/1.0*(b1 * Nx[j] + b2 * Ny[j]) * N[i]; \textcolor{comment}{//   TO DO}}
\DoxyCodeLine{347             \textcolor{comment}{// val += c0 * ((Nx[j] * Nx[i]) + (Ny[j] * Ny[i]));}}
\DoxyCodeLine{348             \textcolor{comment}{// val += c * N[i] * N[j];}}
\DoxyCodeLine{349 }
\DoxyCodeLine{350             A11[i][j] += val * quad\_wt;}
\DoxyCodeLine{351         \} \textcolor{comment}{// endfor j}}
\DoxyCodeLine{352     \}     \textcolor{comment}{// endfor i}}
\DoxyCodeLine{353 \}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355 \textcolor{keywordtype}{void} DO\_Mode\_RHS\_Aux\_Param(\textcolor{keywordtype}{double} *in, \textcolor{keywordtype}{double} *out)}
\DoxyCodeLine{356 \{}
\DoxyCodeLine{357     out = in;}
\DoxyCodeLine{358 \}}
\DoxyCodeLine{359 }
\DoxyCodeLine{361 }
\DoxyCodeLine{362 \textcolor{comment}{// This function will take care of the Additional terms that go into both the co-\/efficient equation and the mode equation}}
\DoxyCodeLine{363 \textcolor{comment}{// The terms in the Coefficient equation and the Mode equation are repeating , So the local RHS matrix will be reused in both the}}
\DoxyCodeLine{364 \textcolor{comment}{//}}
\DoxyCodeLine{365 }
\DoxyCodeLine{366 \textcolor{keywordtype}{void} \mbox{\hyperlink{linear__advection__do__test_8h_a95b3fb737c94e5ffcb06c258523d2b94}{DO\_Mode\_RHS}}(TFESpace2D *Fespace, TFEVectFunct2D *FeVector\_C, \textcolor{keywordtype}{int} N\_S,\textcolor{keywordtype}{double}* GlobalRhs\_mode , \textcolor{keywordtype}{int} i\_index)}
\DoxyCodeLine{367 \{}
\DoxyCodeLine{368 }
\DoxyCodeLine{369     \textcolor{keywordtype}{int} N\_Cells = Fespace-\/>GetN\_Cells();}
\DoxyCodeLine{370     TCollection* coll = Fespace-\/>GetCollection();}
\DoxyCodeLine{371 }
\DoxyCodeLine{372     \textcolor{comment}{// Get the Global DOF arrays INdex from the FE Space. }}
\DoxyCodeLine{373     \textcolor{keywordtype}{int}* GlobalNumbers = Fespace-\/>GetGlobalNumbers();}
\DoxyCodeLine{374     \textcolor{keywordtype}{int}* BeginIndex = Fespace-\/>GetBeginIndex();}
\DoxyCodeLine{375 }
\DoxyCodeLine{376     \textcolor{comment}{// -\/-\/-\/ Quadrature Formula Arrays  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{377     \textcolor{keywordtype}{int} N\_Points2;}
\DoxyCodeLine{378     \textcolor{keywordtype}{double} *Weights2, *t1, *t2;      \textcolor{comment}{// Weights -\/ Quadrature Weights array ; t1  -\/-\/ Quadrature point ( xi ) in ref coordinate ; t2 -\/  Quadrature Point ( eta ) in Ref Coordinate }}
\DoxyCodeLine{379     \textcolor{keywordtype}{bool} Needs2ndDer[1]; }
\DoxyCodeLine{380     Needs2ndDer[0] = TRUE;}
\DoxyCodeLine{381     \textcolor{keywordtype}{double} AbsDetjk[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{382     \textcolor{keywordtype}{double} X[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{383     \textcolor{keywordtype}{double} Y[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{384 }
\DoxyCodeLine{385 }
\DoxyCodeLine{386     \textcolor{comment}{// FE Values Arrays }}
\DoxyCodeLine{387     \textcolor{keywordtype}{double}** origvaluesD00;           \textcolor{comment}{// Shape function values at quadrature Points}}
\DoxyCodeLine{388     \textcolor{keywordtype}{double}** origvaluesD10;           \textcolor{comment}{// Shape Function Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{389     \textcolor{keywordtype}{double}** origvaluesD01;           \textcolor{comment}{// Shape Function Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{390     \textcolor{keywordtype}{double}** origvaluesD20;           \textcolor{comment}{// Shape Function 2nd Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{391     \textcolor{keywordtype}{double}** origvaluesD02;           \textcolor{comment}{// Shape Function 2nd Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{392 }
\DoxyCodeLine{393 }
\DoxyCodeLine{394     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} cellId = 0; cellId < 1; cellId++)}
\DoxyCodeLine{395     \{}
\DoxyCodeLine{396         TBaseCell* currentCell = coll-\/>GetCell(cellId);}
\DoxyCodeLine{397         \textcolor{comment}{// Get the "{}ID"{} of Finite Element for the given 2D Element ( Conforming/NonConforming-\/Order Finite Element : eg : it could be Conforming-\/2nd order Finite Element )}}
\DoxyCodeLine{398         FE2D elementId = Fespace-\/>GetFE2D(cellId, currentCell);}
\DoxyCodeLine{399         \textcolor{comment}{// Get the Class object for that 2d FEM Element , which has all the details like Shape functions , Nodal point locations for that location, Reference Transformation ( Affine , Bilinear )}}
\DoxyCodeLine{400         TFE2D *element = TFEDatabase2D::GetFE2D(elementId);}
\DoxyCodeLine{401         TFEDesc2D *fedesc = element-\/>GetFEDesc2D();}
\DoxyCodeLine{402         \textcolor{comment}{// Class for basis functions in 2D ( Number of basis functions ), basis function values and Derivatives}}
\DoxyCodeLine{403         TBaseFunct2D* bf = element-\/>GetBaseFunct2D();}
\DoxyCodeLine{404         \textcolor{comment}{// Get the Reference Elemet}}
\DoxyCodeLine{405         BF2DRefElements RefElement = TFEDatabase2D::GetRefElementFromFE2D(elementId);}
\DoxyCodeLine{406         \textcolor{comment}{// Get the reference Transformation -\/-\/ Affine Mapping / Bilnea Mapping of Triangle or Quadrilateral}}
\DoxyCodeLine{407         RefTrans2D referenceTransformation =  TFEDatabase2D::GetRefTrans2D\_IDFromFE2D(elementId);}
\DoxyCodeLine{408         \textcolor{comment}{// Get the number of basis functions in the Current Cell ( Number of Local DOF)}}
\DoxyCodeLine{409         \textcolor{keywordtype}{int} N\_BaseFunct = element-\/>GetN\_DOF();}
\DoxyCodeLine{410         \textcolor{comment}{// Type of Basis Function in 2D}}
\DoxyCodeLine{411         BaseFunct2D BaseFunct\_ID = element-\/>GetBaseFunct2D\_ID();}
\DoxyCodeLine{412 }
\DoxyCodeLine{413         \textcolor{comment}{// get cell measure}}
\DoxyCodeLine{414         \textcolor{keywordtype}{double} hK = currentCell-\/>GetDiameter();}
\DoxyCodeLine{415 }
\DoxyCodeLine{416         }
\DoxyCodeLine{417         \textcolor{keywordflow}{switch} (referenceTransformation)}
\DoxyCodeLine{418         \{}
\DoxyCodeLine{419             \textcolor{keywordflow}{case} QuadBilinear:}
\DoxyCodeLine{420             \{}
\DoxyCodeLine{421                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{422                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{423                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{424                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{425 }
\DoxyCodeLine{426                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{427                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadBilinear);}
\DoxyCodeLine{428                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadBilinear);                               \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{429 }
\DoxyCodeLine{430                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{431                 TFEDatabase2D::GetOrigFromRef(QuadBilinear,N\_Points2, t1,t2,  X,Y, AbsDetjk);               \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{432 }
\DoxyCodeLine{433                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{434                 TFEDatabase2D::GetOrigValues(QuadBilinear, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{435                 }
\DoxyCodeLine{436                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{437                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{438                 origvaluesD00       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);               \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{439                 origvaluesD10       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{440                 origvaluesD01       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{441                 origvaluesD20       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{442                 origvaluesD02       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{443                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{444             \}}
\DoxyCodeLine{445 }
\DoxyCodeLine{446 }
\DoxyCodeLine{447             \textcolor{keywordflow}{case} QuadAffin:}
\DoxyCodeLine{448             \{}
\DoxyCodeLine{449                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{450                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{451                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{452                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{453 }
\DoxyCodeLine{454                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{455                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadAffin);}
\DoxyCodeLine{456                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadAffin);                                  \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{457 }
\DoxyCodeLine{458                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{459                 TFEDatabase2D::GetOrigFromRef(QuadAffin,N\_Points2, t1,t2,  X,Y, AbsDetjk);   \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{460 }
\DoxyCodeLine{461                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{462                 TFEDatabase2D::GetOrigValues(QuadAffin, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{463                 }
\DoxyCodeLine{464 }
\DoxyCodeLine{465                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{466                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{467                 origvaluesD00 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);             \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{468                 origvaluesD10 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{469                 origvaluesD01 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{470                 origvaluesD20 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Points}}
\DoxyCodeLine{471                 origvaluesD02 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{472 }
\DoxyCodeLine{473                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{474             \}}
\DoxyCodeLine{475                     }
\DoxyCodeLine{476             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{477             \{}
\DoxyCodeLine{478                 cout << \textcolor{stringliteral}{"{} [ERROR] -\/ Error in File : CoeffEqn\_DO.C "{}} <<endl;}
\DoxyCodeLine{479                 cout << \textcolor{stringliteral}{"{} Unknown Reftype "{}} <<endl;}
\DoxyCodeLine{480                 cout << \textcolor{stringliteral}{"{} REF TYPE : "{}} << referenceTransformation <<endl;}
\DoxyCodeLine{481                 exit(0);}
\DoxyCodeLine{482                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{483 }
\DoxyCodeLine{484             \}}
\DoxyCodeLine{485         \}}
\DoxyCodeLine{486 }
\DoxyCodeLine{487         \textcolor{keywordtype}{int}* DOF = GlobalNumbers + BeginIndex[cellId];}
\DoxyCodeLine{488         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{489         }
\DoxyCodeLine{490         \textcolor{keywordtype}{double}* C\_Array = FeVector\_C-\/>GetValues();}
\DoxyCodeLine{491         \textcolor{keywordtype}{int} len         = FeVector\_C-\/>GetLength();}
\DoxyCodeLine{492 }
\DoxyCodeLine{493         }
\DoxyCodeLine{494 }
\DoxyCodeLine{495         \textcolor{keywordtype}{double}* C\_Array\_i = C\_Array + i\_index*len;}
\DoxyCodeLine{496 }
\DoxyCodeLine{497         }
\DoxyCodeLine{498         \textcolor{comment}{// Save Values of C at all quadrature points for I component}}
\DoxyCodeLine{499         \textcolor{keywordtype}{double} C\_i[N\_Points2];}
\DoxyCodeLine{500         \textcolor{keywordtype}{double} C\_x\_i[N\_Points2];}
\DoxyCodeLine{501         \textcolor{keywordtype}{double} C\_y\_i[N\_Points2];}
\DoxyCodeLine{502 }
\DoxyCodeLine{503         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_i[quadPt] = 0;}
\DoxyCodeLine{504         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_i[quadPt] = 0;}
\DoxyCodeLine{505         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_i[quadPt] = 0;}
\DoxyCodeLine{506         }
\DoxyCodeLine{507         }
\DoxyCodeLine{508         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{509         \{}
\DoxyCodeLine{510             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{511             \{}
\DoxyCodeLine{512                 \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{513                 C\_i[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{514                 C\_x\_i[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{515                 C\_y\_i[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{516             \}}
\DoxyCodeLine{517         \}}
\DoxyCodeLine{518         }
\DoxyCodeLine{519         \textcolor{keywordtype}{double} rhs[N\_BaseFunct];}
\DoxyCodeLine{520         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 0 ; j < N\_BaseFunct; j++) rhs[j] = 0;}
\DoxyCodeLine{521 }
\DoxyCodeLine{522         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} a = 0 ; a < N\_S ; a++)}
\DoxyCodeLine{523         \{}
\DoxyCodeLine{524             \textcolor{keywordtype}{double}* C\_Array\_a = C\_Array + i\_index*len;}
\DoxyCodeLine{525 }
\DoxyCodeLine{526             \textcolor{keywordtype}{double} C\_a[N\_Points2];}
\DoxyCodeLine{527             \textcolor{keywordtype}{double} C\_x\_a[N\_Points2];}
\DoxyCodeLine{528             \textcolor{keywordtype}{double} C\_y\_a[N\_Points2];}
\DoxyCodeLine{529 }
\DoxyCodeLine{530             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_a[quadPt] = 0;}
\DoxyCodeLine{531             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_a[quadPt] = 0;}
\DoxyCodeLine{532             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_a[quadPt] = 0;}
\DoxyCodeLine{533 }
\DoxyCodeLine{534             \textcolor{comment}{// Obtain all values for C\_a}}
\DoxyCodeLine{535             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{536             \{}
\DoxyCodeLine{537                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{538                 \{}
\DoxyCodeLine{539                     \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{540                     C\_a[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{541                     \textcolor{comment}{// C\_x\_a[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_a[globDOF];}}
\DoxyCodeLine{542                     \textcolor{comment}{// C\_y\_a[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_a[globDOF];}}
\DoxyCodeLine{543                 \}}
\DoxyCodeLine{544             \}}
\DoxyCodeLine{545             }
\DoxyCodeLine{546 }
\DoxyCodeLine{547 }
\DoxyCodeLine{548             \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{549             \textcolor{comment}{//Get Coefficients b1 and b2}}
\DoxyCodeLine{550             \textcolor{keywordtype}{double} *Param[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{551             \textcolor{keywordtype}{double} **Coeffs =  \textcolor{keyword}{new} \textcolor{keywordtype}{double}*[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{552             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < MaxN\_QuadPoints\_2D; i++)}
\DoxyCodeLine{553             \{}
\DoxyCodeLine{554                 Coeffs[i] = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[10]();}
\DoxyCodeLine{555             \}}
\DoxyCodeLine{556             }
\DoxyCodeLine{557             }
\DoxyCodeLine{558 }
\DoxyCodeLine{559             DO\_Mode\_Equation\_Coefficients(N\_Points2,X, Y,Param, Coeffs);}
\DoxyCodeLine{560             }
\DoxyCodeLine{561             \textcolor{comment}{// INner Quadrature Loop }}
\DoxyCodeLine{562             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{563             \{}
\DoxyCodeLine{564                 \textcolor{keywordtype}{double} Mult = Weights2[quadPt] * AbsDetjk[quadPt];}
\DoxyCodeLine{565                 \textcolor{keywordtype}{double}* orgD00 = origvaluesD00[quadPt];}
\DoxyCodeLine{566                 \textcolor{keywordtype}{double}* orgD10 = origvaluesD10[quadPt];}
\DoxyCodeLine{567                 \textcolor{keywordtype}{double}* orgD01 = origvaluesD01[quadPt];}
\DoxyCodeLine{568                 \textcolor{keywordtype}{double}* orgD20 = origvaluesD20[quadPt];}
\DoxyCodeLine{569                 \textcolor{keywordtype}{double}* orgD02 = origvaluesD02[quadPt];}
\DoxyCodeLine{570 }
\DoxyCodeLine{571                 \textcolor{keywordtype}{double} b1 = Coeffs[quadPt][1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{572                 \textcolor{keywordtype}{double} b2 = Coeffs[quadPt][2]; \textcolor{comment}{// b1}}
\DoxyCodeLine{573 }
\DoxyCodeLine{574                 }
\DoxyCodeLine{575                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt\_1 = 0 ; quadPt\_1 < N\_Points2; quadPt\_1++)}
\DoxyCodeLine{576                 \{}
\DoxyCodeLine{577                     val += (b1*C\_x\_i[quadPt\_1] + b2*C\_y\_i[quadPt\_1])*C\_a[quadPt\_1];}
\DoxyCodeLine{578                     val *= Mult;}
\DoxyCodeLine{579                 \}}
\DoxyCodeLine{580 }
\DoxyCodeLine{581                 val *= -\/1.0*C\_a[quadPt] ;  \textcolor{comment}{// This is Final "{}f"{}}}
\DoxyCodeLine{582 }
\DoxyCodeLine{583                 \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 0 ; j < N\_BaseFunct ; j++)}
\DoxyCodeLine{584                 \{}
\DoxyCodeLine{585                     rhs[j] += val * orgD00[j] * Mult;   }
\DoxyCodeLine{586                     }
\DoxyCodeLine{587                 \}}
\DoxyCodeLine{588 }
\DoxyCodeLine{589             \}}
\DoxyCodeLine{590 }
\DoxyCodeLine{591         \}}
\DoxyCodeLine{592 }
\DoxyCodeLine{593         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 0 ; j < N\_BaseFunct ; j++)}
\DoxyCodeLine{594         \{}
\DoxyCodeLine{595             \textcolor{keywordtype}{int} GlobalDOF                   = DOF[j];}
\DoxyCodeLine{596             GlobalRhs\_mode[GlobalDOF]       += rhs[j];}
\DoxyCodeLine{597         \}}
\DoxyCodeLine{598         \textcolor{comment}{// -\/-\/ }}
\DoxyCodeLine{599     \}}
\DoxyCodeLine{600 \}}
\DoxyCodeLine{601 }
\DoxyCodeLine{602 }
\DoxyCodeLine{603 }
\DoxyCodeLine{604 \textcolor{keywordtype}{void} DO\_CoEfficient(TFESpace2D *Fespace, TFEVectFunct2D *FeVector\_C\_Mode,TFEVectFunct2D* FEVector\_Phi, \textcolor{keywordtype}{int} N\_S, \textcolor{keywordtype}{int} i\_index,\textcolor{keywordtype}{int} N\_R)}
\DoxyCodeLine{605 \{}
\DoxyCodeLine{606 }
\DoxyCodeLine{607     \textcolor{keywordtype}{int} N\_Cells = Fespace-\/>GetN\_Cells();}
\DoxyCodeLine{608     TCollection* coll = Fespace-\/>GetCollection();}
\DoxyCodeLine{609 }
\DoxyCodeLine{610     \textcolor{comment}{// Get the Global DOF arrays INdex from the FE Space. }}
\DoxyCodeLine{611     \textcolor{keywordtype}{int}* GlobalNumbers = Fespace-\/>GetGlobalNumbers();}
\DoxyCodeLine{612     \textcolor{keywordtype}{int}* BeginIndex = Fespace-\/>GetBeginIndex();}
\DoxyCodeLine{613 }
\DoxyCodeLine{614     \textcolor{comment}{// -\/-\/-\/ Quadrature Formula Arrays  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{615     \textcolor{keywordtype}{int} N\_Points2;}
\DoxyCodeLine{616     \textcolor{keywordtype}{double} *Weights2, *t1, *t2;      \textcolor{comment}{// Weights -\/ Quadrature Weights array ; t1  -\/-\/ Quadrature point ( xi ) in ref coordinate ; t2 -\/  Quadrature Point ( eta ) in Ref Coordinate }}
\DoxyCodeLine{617     \textcolor{keywordtype}{bool} Needs2ndDer[1]; }
\DoxyCodeLine{618     Needs2ndDer[0] = TRUE;}
\DoxyCodeLine{619     \textcolor{keywordtype}{double} AbsDetjk[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{620     \textcolor{keywordtype}{double} X[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{621     \textcolor{keywordtype}{double} Y[MaxN\_PointsForNodal2D];}
\DoxyCodeLine{622 }
\DoxyCodeLine{623 }
\DoxyCodeLine{624     \textcolor{comment}{// FE Values Arrays }}
\DoxyCodeLine{625     \textcolor{keywordtype}{double}** origvaluesD00;           \textcolor{comment}{// Shape function values at quadrature Points}}
\DoxyCodeLine{626     \textcolor{keywordtype}{double}** origvaluesD10;           \textcolor{comment}{// Shape Function Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{627     \textcolor{keywordtype}{double}** origvaluesD01;           \textcolor{comment}{// Shape Function Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{628     \textcolor{keywordtype}{double}** origvaluesD20;           \textcolor{comment}{// Shape Function 2nd Derivatives ( x ) at Quadrature Points}}
\DoxyCodeLine{629     \textcolor{keywordtype}{double}** origvaluesD02;           \textcolor{comment}{// Shape Function 2nd Derivatives ( y ) at Quadrature Points}}
\DoxyCodeLine{630 }
\DoxyCodeLine{631     \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{632     \textcolor{keywordtype}{double}* C\_Array = FeVector\_C\_Mode-\/>GetValues();}
\DoxyCodeLine{633     \textcolor{keywordtype}{int} lenMode         = FeVector\_C\_Mode-\/>GetLength();}
\DoxyCodeLine{634 }
\DoxyCodeLine{635 }
\DoxyCodeLine{636     \textcolor{keywordtype}{double}* Phi\_Array = FEVector\_Phi-\/>GetValues();}
\DoxyCodeLine{637     \textcolor{keywordtype}{double}* Phi\_Old = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[N\_R*N\_S]();}
\DoxyCodeLine{638     memcpy(Phi\_Old,Phi\_Array,N\_R*N\_S*SizeOfDouble);}
\DoxyCodeLine{639     \textcolor{keywordtype}{int} lenPhi         = FEVector\_Phi-\/>GetLength();}
\DoxyCodeLine{640     cout << \textcolor{stringliteral}{"{}************** Length of Phi = "{}} << lenPhi << endl;}
\DoxyCodeLine{641     \textcolor{keywordtype}{double}* phi\_New = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[lenPhi]();}
\DoxyCodeLine{642     \textcolor{keywordtype}{double}* C\_Array\_i = C\_Array + i\_index*lenMode;}
\DoxyCodeLine{643     \textcolor{comment}{// double* phi\_Array\_i = Phi\_Array + i\_index*lenMode; ??}}
\DoxyCodeLine{644     \textcolor{keywordtype}{double}* phi\_Array\_i = Phi\_Array + i\_index*lenPhi;}
\DoxyCodeLine{645     \textcolor{keywordtype}{double}* phi\_Old\_i = Phi\_Old + i\_index*lenPhi;}
\DoxyCodeLine{646 }
\DoxyCodeLine{647 }
\DoxyCodeLine{648 }
\DoxyCodeLine{649 }
\DoxyCodeLine{650     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} cellId = 0; cellId < 1; cellId++)}
\DoxyCodeLine{651     \{}
\DoxyCodeLine{652         TBaseCell* currentCell = coll-\/>GetCell(cellId);}
\DoxyCodeLine{653         \textcolor{comment}{// Get the "{}ID"{} of Finite Element for the given 2D Element ( Conforming/NonConforming-\/Order Finite Element : eg : it could be Conforming-\/2nd order Finite Element )}}
\DoxyCodeLine{654         FE2D elementId = Fespace-\/>GetFE2D(cellId, currentCell);}
\DoxyCodeLine{655         \textcolor{comment}{// Get the Class object for that 2d FEM Element , which has all the details like Shape functions , Nodal point locations for that location, Reference Transformation ( Affine , Bilinear )}}
\DoxyCodeLine{656         TFE2D *element = TFEDatabase2D::GetFE2D(elementId);}
\DoxyCodeLine{657         TFEDesc2D *fedesc = element-\/>GetFEDesc2D();}
\DoxyCodeLine{658         \textcolor{comment}{// Class for basis functions in 2D ( Number of basis functions ), basis function values and Derivatives}}
\DoxyCodeLine{659         TBaseFunct2D* bf = element-\/>GetBaseFunct2D();}
\DoxyCodeLine{660         \textcolor{comment}{// Get the Reference Elemet}}
\DoxyCodeLine{661         BF2DRefElements RefElement = TFEDatabase2D::GetRefElementFromFE2D(elementId);}
\DoxyCodeLine{662         \textcolor{comment}{// Get the reference Transformation -\/-\/ Affine Mapping / Bilnea Mapping of Triangle or Quadrilateral}}
\DoxyCodeLine{663         RefTrans2D referenceTransformation =  TFEDatabase2D::GetRefTrans2D\_IDFromFE2D(elementId);}
\DoxyCodeLine{664         \textcolor{comment}{// Get the number of basis functions in the Current Cell ( Number of Local DOF)}}
\DoxyCodeLine{665         \textcolor{keywordtype}{int} N\_BaseFunct = element-\/>GetN\_DOF();}
\DoxyCodeLine{666         \textcolor{comment}{// Type of Basis Function in 2D}}
\DoxyCodeLine{667         BaseFunct2D BaseFunct\_ID = element-\/>GetBaseFunct2D\_ID();}
\DoxyCodeLine{668 }
\DoxyCodeLine{669         \textcolor{comment}{// get cell measure}}
\DoxyCodeLine{670         \textcolor{keywordtype}{double} hK = currentCell-\/>GetDiameter();}
\DoxyCodeLine{671 }
\DoxyCodeLine{672         }
\DoxyCodeLine{673         \textcolor{keywordflow}{switch} (referenceTransformation)}
\DoxyCodeLine{674         \{}
\DoxyCodeLine{675             \textcolor{keywordflow}{case} QuadBilinear:}
\DoxyCodeLine{676             \{}
\DoxyCodeLine{677                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{678                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{679                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{680                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{681 }
\DoxyCodeLine{682                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{683                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadBilinear);}
\DoxyCodeLine{684                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadBilinear);                               \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{685 }
\DoxyCodeLine{686                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{687                 TFEDatabase2D::GetOrigFromRef(QuadBilinear,N\_Points2, t1,t2,  X,Y, AbsDetjk);               \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{688 }
\DoxyCodeLine{689                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{690                 TFEDatabase2D::GetOrigValues(QuadBilinear, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{691                 }
\DoxyCodeLine{692                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{693                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{694                 origvaluesD00       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);               \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{695                 origvaluesD10       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{696                 origvaluesD01       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);               \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{697                 origvaluesD20       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{698                 origvaluesD02       = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);               \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{699                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{700             \}}
\DoxyCodeLine{701 }
\DoxyCodeLine{702 }
\DoxyCodeLine{703             \textcolor{keywordflow}{case} QuadAffin:}
\DoxyCodeLine{704             \{}
\DoxyCodeLine{705                 \textcolor{keywordtype}{int} l = bf-\/>GetPolynomialDegree();                                                  \textcolor{comment}{// Get the Polynomial Degreee  of the basis functions}}
\DoxyCodeLine{706                 QuadFormula2D QF2 = TFEDatabase2D::GetQFQuadFromDegree(3*l);                        \textcolor{comment}{// Get te ID of Quadrature Formula}}
\DoxyCodeLine{707                 TQuadFormula2D* QuadratureRule = TFEDatabase2D::GetQuadFormula2D(QF2);              \textcolor{comment}{// Get the Quadrature Rule Objetc based on Quadrature ID}}
\DoxyCodeLine{708                 QuadratureRule-\/>GetFormulaData(N\_Points2, Weights2, t1, t2);                        \textcolor{comment}{// get the Quadrature points , Weights }}
\DoxyCodeLine{709 }
\DoxyCodeLine{710                 \textcolor{comment}{// Set the values on the Reference Cell}}
\DoxyCodeLine{711                 TRefTrans2D* F\_K = TFEDatabase2D::GetRefTrans2D(QuadAffin);}
\DoxyCodeLine{712                 TFEDatabase2D::SetCellForRefTrans(currentCell, QuadAffin);                                  \textcolor{comment}{// Set the Cell for Current reference Transformation}}
\DoxyCodeLine{713 }
\DoxyCodeLine{714                 \textcolor{comment}{// Get Original Coordinates from reference Coordinates and the Determinant of jacobian}}
\DoxyCodeLine{715                 TFEDatabase2D::GetOrigFromRef(QuadAffin,N\_Points2, t1,t2,  X,Y, AbsDetjk);   \textcolor{comment}{// Get the Original Co-\/orinates for the cell from xi values}}
\DoxyCodeLine{716 }
\DoxyCodeLine{717                 \textcolor{comment}{// Get all the original Values from the Referece cell values.}}
\DoxyCodeLine{718                 TFEDatabase2D::GetOrigValues(QuadAffin, 1, \&BaseFunct\_ID, N\_Points2, t1, t2, QF2, Needs2ndDer);}
\DoxyCodeLine{719                 }
\DoxyCodeLine{720 }
\DoxyCodeLine{721                 \textcolor{comment}{// The below are 2D arrays in the form }}
\DoxyCodeLine{722                 \textcolor{comment}{// Values[QuadraturePointLocation][ShapeFunction]  i.e, the Value of Shapefunction at all quadrature points for each shape functions}}
\DoxyCodeLine{723                 origvaluesD00 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D00);             \textcolor{comment}{// Shape Function Values at Quadrature Points }}
\DoxyCodeLine{724                 origvaluesD10 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D10);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Points}}
\DoxyCodeLine{725                 origvaluesD01 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D01);             \textcolor{comment}{// Shape Function Derivative Values at Quadrature Point}}
\DoxyCodeLine{726                 origvaluesD20 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D20);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Points}}
\DoxyCodeLine{727                 origvaluesD02 = TFEDatabase2D::GetOrigElementValues(BaseFunct\_ID, D02);             \textcolor{comment}{// Shape Function 2nd Derivative Values at Quadrature Point}}
\DoxyCodeLine{728 }
\DoxyCodeLine{729                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{730             \}}
\DoxyCodeLine{731                     }
\DoxyCodeLine{732             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{733             \{}
\DoxyCodeLine{734                 cout << \textcolor{stringliteral}{"{} [ERROR] -\/ Error in File : CoeffEqn\_DO.C "{}} <<endl;}
\DoxyCodeLine{735                 cout << \textcolor{stringliteral}{"{} Unknown Reftype "{}} <<endl;}
\DoxyCodeLine{736                 cout << \textcolor{stringliteral}{"{} REF TYPE : "{}} << referenceTransformation <<endl;}
\DoxyCodeLine{737                 exit(0);}
\DoxyCodeLine{738                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{739 }
\DoxyCodeLine{740             \}}
\DoxyCodeLine{741         \}}
\DoxyCodeLine{742 }
\DoxyCodeLine{743         \textcolor{keywordtype}{int}* DOF = GlobalNumbers + BeginIndex[cellId];}
\DoxyCodeLine{744         \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{745 }
\DoxyCodeLine{746         \textcolor{comment}{// Save Values of C at all quadrature points for I component}}
\DoxyCodeLine{747         \textcolor{keywordtype}{double} C\_i[N\_Points2];}
\DoxyCodeLine{748         \textcolor{keywordtype}{double} C\_x\_i[N\_Points2];}
\DoxyCodeLine{749         \textcolor{keywordtype}{double} C\_y\_i[N\_Points2];}
\DoxyCodeLine{750 }
\DoxyCodeLine{751 }
\DoxyCodeLine{752         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_i[quadPt] = 0;}
\DoxyCodeLine{753         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_i[quadPt] = 0;}
\DoxyCodeLine{754         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_i[quadPt] = 0;}
\DoxyCodeLine{755 }
\DoxyCodeLine{756         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{757         \{}
\DoxyCodeLine{758             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{759             \{}
\DoxyCodeLine{760                 \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{761                 C\_i[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_i[globDOF];}
\DoxyCodeLine{762                 \textcolor{comment}{// C\_x\_i[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_i[globDOF];}}
\DoxyCodeLine{763                 \textcolor{comment}{// C\_y\_i[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_i[globDOF];}}
\DoxyCodeLine{764             \}}
\DoxyCodeLine{765         \}}
\DoxyCodeLine{766 }
\DoxyCodeLine{767 }
\DoxyCodeLine{768         \textcolor{comment}{// for ( int j = 0 ; j < N\_BaseFunct; j++) rhs[j] = 0;}}
\DoxyCodeLine{769 }
\DoxyCodeLine{770         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} a = 0 ; a < N\_S ; a++)}
\DoxyCodeLine{771         \{}
\DoxyCodeLine{772             \textcolor{keywordtype}{double}* C\_Array\_a = C\_Array + a*lenMode;}
\DoxyCodeLine{773             \textcolor{comment}{// double* phi\_Array\_a = Phi\_Array + a*lenMode;??}}
\DoxyCodeLine{774             \textcolor{keywordtype}{double}* phi\_Array\_a = Phi\_Array + a*lenPhi;}
\DoxyCodeLine{775 }
\DoxyCodeLine{776             \textcolor{keywordtype}{double} C\_a[N\_Points2];}
\DoxyCodeLine{777             \textcolor{keywordtype}{double} C\_x\_a[N\_Points2];}
\DoxyCodeLine{778             \textcolor{keywordtype}{double} C\_y\_a[N\_Points2];}
\DoxyCodeLine{779 }
\DoxyCodeLine{780             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_a[quadPt] = 0;}
\DoxyCodeLine{781             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_x\_a[quadPt] = 0;}
\DoxyCodeLine{782             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++) C\_y\_a[quadPt] = 0;}
\DoxyCodeLine{783 }
\DoxyCodeLine{784 }
\DoxyCodeLine{785             \textcolor{comment}{// Obtain all values for C\_a}}
\DoxyCodeLine{786             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{787             \{}
\DoxyCodeLine{788                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0 ; j  < N\_BaseFunct ;  j++)}
\DoxyCodeLine{789                 \{}
\DoxyCodeLine{790                     \textcolor{keywordtype}{int} globDOF = DOF[j];}
\DoxyCodeLine{791                     C\_a[quadPt] += origvaluesD00[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{792                     C\_x\_a[quadPt] += origvaluesD10[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{793                     C\_y\_a[quadPt] += origvaluesD01[quadPt][j] * C\_Array\_a[globDOF];}
\DoxyCodeLine{794                 \}}
\DoxyCodeLine{795             \}}
\DoxyCodeLine{796             }
\DoxyCodeLine{797 }
\DoxyCodeLine{798 }
\DoxyCodeLine{799             \textcolor{comment}{//Get Coefficients b1 and b2}}
\DoxyCodeLine{800             \textcolor{keywordtype}{double} *Param[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{801             \textcolor{keywordtype}{double} **Coeffs =  \textcolor{keyword}{new} \textcolor{keywordtype}{double}*[MaxN\_QuadPoints\_2D];}
\DoxyCodeLine{802             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < MaxN\_QuadPoints\_2D; i++)}
\DoxyCodeLine{803             \{}
\DoxyCodeLine{804                 Coeffs[i] = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[10]();}
\DoxyCodeLine{805             \}}
\DoxyCodeLine{806             }
\DoxyCodeLine{807 }
\DoxyCodeLine{808             DO\_Mode\_Equation\_Coefficients(N\_Points2,X, Y,Param, Coeffs);}
\DoxyCodeLine{809             }
\DoxyCodeLine{810             \textcolor{comment}{// INner Quadrature Loop }}
\DoxyCodeLine{811             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} quadPt = 0 ; quadPt < N\_Points2; quadPt++)}
\DoxyCodeLine{812             \{}
\DoxyCodeLine{813                 \textcolor{keywordtype}{double} Mult = Weights2[quadPt] * AbsDetjk[quadPt];}
\DoxyCodeLine{814                 \textcolor{keywordtype}{double}* orgD00 = origvaluesD00[quadPt];}
\DoxyCodeLine{815                 \textcolor{keywordtype}{double}* orgD10 = origvaluesD10[quadPt];}
\DoxyCodeLine{816                 \textcolor{keywordtype}{double}* orgD01 = origvaluesD01[quadPt];}
\DoxyCodeLine{817                 \textcolor{keywordtype}{double}* orgD20 = origvaluesD20[quadPt];}
\DoxyCodeLine{818                 \textcolor{keywordtype}{double}* orgD02 = origvaluesD02[quadPt];}
\DoxyCodeLine{819 }
\DoxyCodeLine{820                 \textcolor{keywordtype}{double} b1 = Coeffs[quadPt][1]; \textcolor{comment}{// b1}}
\DoxyCodeLine{821                 \textcolor{keywordtype}{double} b2 = Coeffs[quadPt][2]; \textcolor{comment}{// b1}}
\DoxyCodeLine{822                 \textcolor{comment}{// double b1 = 1;}}
\DoxyCodeLine{823                 \textcolor{comment}{// double b2 = 1;}}
\DoxyCodeLine{824 }
\DoxyCodeLine{825                 val += (b1*C\_x\_a[quadPt] + b2*C\_y\_a[quadPt])*C\_i[quadPt];}
\DoxyCodeLine{826                 val *= Mult;}
\DoxyCodeLine{827 }
\DoxyCodeLine{828             \}}
\DoxyCodeLine{829     }
\DoxyCodeLine{830 }
\DoxyCodeLine{831             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < lenPhi ; i++)}
\DoxyCodeLine{832             \{}
\DoxyCodeLine{833                 phi\_New[i] += val*phi\_Array\_a[i]*-\/1.0;}
\DoxyCodeLine{834             \}}
\DoxyCodeLine{835 }
\DoxyCodeLine{836         \}}
\DoxyCodeLine{837 }
\DoxyCodeLine{838             }
\DoxyCodeLine{839         }
\DoxyCodeLine{840     \}}
\DoxyCodeLine{841 }
\DoxyCodeLine{842     \textcolor{keywordtype}{double} timeStep = TDatabase::TimeDB-\/>CURRENTTIMESTEPLENGTH;}
\DoxyCodeLine{843     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0 ; i < lenPhi; i++)}
\DoxyCodeLine{844     \{}
\DoxyCodeLine{845         phi\_Array\_i[i] += phi\_Old\_i[i]+ timeStep*phi\_New[i];}
\DoxyCodeLine{846     \}}
\DoxyCodeLine{847 }
\DoxyCodeLine{848     \textcolor{keyword}{delete}[] phi\_New;}
\DoxyCodeLine{849 }
\DoxyCodeLine{850 \}}
\DoxyCodeLine{851 }

\end{DoxyCode}
